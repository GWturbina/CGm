<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–û–ø—Ä–æ—Å</title>
  <meta property="og:title" content="–ü—Ä–æ–π–¥–∏ –æ–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏ –ø–æ–¥–∞—Ä–æ–∫! üéÅ">
  <meta property="og:description" content="–û—Ç–≤–µ—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å">
  <meta property="og:image" content="https://cardgift.vercel.app/og-survey.png">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìã</text></svg>">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--gold:#FFD700;--gold-dark:#B8860B;--bg-dark:#0f1419;--bg-card:#1a1f2e;--bg-lighter:#242b3d;--text:#E8E8E8;--text-muted:#9CA3AF;--accent:#00d4ff;--green:#4CAF50;--red:#f44336;--orange:#ff9800;--purple:#9c27b0;--border:rgba(255,215,0,0.2)}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:linear-gradient(135deg,var(--bg-dark),#1a1a2e,var(--bg-dark));color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .container{width:100%;max-width:500px}
    .card{background:var(--bg-card);border:1px solid var(--border);border-radius:20px;padding:30px;margin-bottom:20px}
    .header{text-align:center;margin-bottom:30px}
    .header-icon{font-size:60px;margin-bottom:15px;display:block}
    .header h1{font-size:24px;color:var(--gold);margin-bottom:8px}
    .header p{color:var(--text-muted);font-size:14px}
    .progress-container{margin-bottom:25px}
    .progress-text{display:flex;justify-content:space-between;font-size:12px;color:var(--text-muted);margin-bottom:8px}
    .progress-bar{height:8px;background:var(--bg-lighter);border-radius:4px;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,var(--gold),var(--gold-dark));transition:width .3s}
    .question{margin-bottom:25px}
    .question-title{font-size:18px;margin-bottom:20px;line-height:1.4}
    .question-num{color:var(--gold);font-size:14px;margin-bottom:8px}
    .options{display:flex;flex-direction:column;gap:12px}
    .option{background:var(--bg-lighter);border:2px solid var(--border);border-radius:12px;padding:16px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:12px}
    .option:hover{border-color:var(--gold);transform:translateX(5px)}
    .option.selected{border-color:var(--gold);background:rgba(255,215,0,.1)}
    .option-radio{width:22px;height:22px;border:2px solid var(--border);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s}
    .option.selected .option-radio{border-color:var(--gold);background:var(--gold)}
    .option.selected .option-radio::after{content:'‚úì';color:#000;font-size:12px;font-weight:bold}
    .option-text{flex:1;font-size:15px}
    .input-group{margin-bottom:15px}
    .input-group label{display:block;font-size:13px;color:var(--text-muted);margin-bottom:6px}
    .input{width:100%;padding:14px 16px;background:var(--bg-lighter);border:1px solid var(--border);border-radius:10px;color:var(--text);font-size:15px}
    .input:focus{outline:none;border-color:var(--gold)}
    .input::placeholder{color:var(--text-muted)}
    .btn{width:100%;padding:16px;border-radius:12px;cursor:pointer;font-size:16px;font-weight:600;border:none;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:8px}
    .btn:hover:not(:disabled){transform:translateY(-2px)}.btn:active{transform:scale(.98)}
    .btn-primary{background:linear-gradient(135deg,var(--gold),var(--gold-dark));color:#000}
    .btn-secondary{background:var(--bg-lighter);border:2px solid var(--border);color:var(--text)}
    .btn-green{background:linear-gradient(135deg,var(--green),#388E3C);color:#fff}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .gift-banner{background:linear-gradient(135deg,rgba(255,215,0,.15),rgba(255,165,0,.1));border:1px solid var(--gold);border-radius:15px;padding:20px;text-align:center;margin-bottom:25px}
    .gift-banner-icon{font-size:40px;margin-bottom:10px}
    .gift-banner h3{color:var(--gold);margin-bottom:5px}
    .gift-banner p{color:var(--text-muted);font-size:13px}
    .share-section{text-align:center}
    .share-title{font-size:20px;color:var(--gold);margin-bottom:10px}
    .share-subtitle{color:var(--text-muted);font-size:14px;margin-bottom:20px}
    .share-link{background:var(--bg-lighter);border:1px solid var(--border);border-radius:10px;padding:12px;display:flex;align-items:center;gap:10px;margin-bottom:20px}
    .share-link input{flex:1;background:none;border:none;color:var(--text);font-size:13px;outline:none}
    .share-link button{background:var(--gold);color:#000;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-weight:600;font-size:12px}
    .share-buttons{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:20px}
    .share-btn{width:50px;height:50px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;transition:all .2s;border:none}
    .share-btn:hover{transform:scale(1.1)}
    .share-btn.telegram{background:#0088cc}
    .share-btn.whatsapp{background:#25D366}
    .share-btn.viber{background:#665CAC}
    .share-btn.copy{background:var(--bg-lighter);border:1px solid var(--border)}
    .stats-row{display:flex;gap:15px;margin-top:20px}
    .stat-item{flex:1;background:var(--bg-lighter);border-radius:10px;padding:15px;text-align:center}
    .stat-value{font-size:24px;font-weight:700;color:var(--gold)}
    .stat-label{font-size:11px;color:var(--text-muted);margin-top:4px}
    .referral-list{margin-top:20px}
    .referral-item{display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg-lighter);border-radius:10px;margin-bottom:10px}
    .referral-avatar{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--gold),var(--gold-dark));display:flex;align-items:center;justify-content:center;font-weight:700;color:#000}
    .referral-info{flex:1}
    .referral-name{font-weight:500;font-size:14px}
    .referral-date{font-size:11px;color:var(--text-muted)}
    .referral-status{font-size:20px}
    .reward-card{background:linear-gradient(135deg,rgba(76,175,80,.2),rgba(76,175,80,.1));border:1px solid var(--green);border-radius:15px;padding:20px;text-align:center;margin-top:20px}
    .reward-card h3{color:var(--green);margin-bottom:5px}
    .reward-card p{color:var(--text-muted);font-size:13px}
    .loading{text-align:center;padding:60px}
    .spinner{width:50px;height:50px;border:3px solid var(--border);border-top-color:var(--gold);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 20px}
    @keyframes spin{to{transform:rotate(360deg)}}
    .error-msg{background:rgba(244,67,54,.2);border:1px solid var(--red);border-radius:10px;padding:12px;color:var(--red);font-size:13px;margin-bottom:15px;text-align:center}
    .success-animation{font-size:80px;animation:bounce .5s}
    @keyframes bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.2)}}
    .confetti{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden;z-index:1000}
    .confetti-piece{position:absolute;width:10px;height:10px;animation:confetti-fall 3s linear forwards}
    @keyframes confetti-fall{0%{transform:translateY(-100px) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}
    .back-btn{position:fixed;top:20px;left:20px;background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:10px 15px;color:var(--text);cursor:pointer;font-size:14px;display:flex;align-items:center;gap:8px;z-index:100}
    .back-btn:hover{border-color:var(--gold)}
    @media(max-width:500px){.card{padding:20px;border-radius:15px}.header h1{font-size:20px}.question-title{font-size:16px}.share-buttons{gap:8px}.share-btn{width:45px;height:45px}}
  </style>
</head>
<body>
<div class="container" id="app"></div>

<script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
window.onerror = function(msg, url, line) {
  const app = document.getElementById('app');
  if (app) {
    app.innerHTML = '<div style="padding:40px;text-align:center;color:#ff6b6b;"><h2>‚ùå –û—à–∏–±–∫–∞ JavaScript</h2><p>' + msg + '</p><p style="font-size:12px;color:#888;">Line: ' + line + '</p><button onclick="location.reload()" style="margin-top:20px;padding:10px 20px;background:#FFD700;border:none;border-radius:8px;cursor:pointer;">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button></div>';
  }
  console.error('Error:', msg, 'Line:', line);
  return false;
};

const CONFIG = {
  SUPABASE_URL: 'https://imgpysvdosdsqucoghqa.supabase.co',
  SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImltZ3B5c3Zkb3Nkc3F1Y29naHFhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1NTU0ODYsImV4cCI6MjA4MjEzMTQ4Nn0.HTRDARe0DkeyI4et9I5xcElToiHzrfJTr2kFpwoik0Y',
  BASE_URL: window.location.origin // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ–º–µ–Ω
};

const supabaseClient = window.supabase ? window.supabase.createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_ANON_KEY) : null;

if (!supabaseClient) {
  console.error('‚ùå Supabase not loaded!');
}

console.log('‚úÖ Supabase client:', supabaseClient ? 'ready' : 'NOT READY');

// –î–µ–º–æ-–æ–ø—Ä–æ—Å (–ø–æ—Ç–æ–º –±—É–¥–µ—Ç –∏–∑ –±–∞–∑—ã)
const DEMO_SURVEY = {
  id: 'demo-1',
  title: '–†–∞–±–æ—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ',
  description: '–£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –æ–Ω–ª–∞–π–Ω-–∑–∞—Ä–∞–±–æ—Ç–∫–∞',
  icon: 'üíº',
  reward_text: '–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –º–∏–Ω–∏-–∫—É—Ä—Å',
  referral_reward: '–ë–æ–Ω—É—Å –∑–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞',
  questions: [
    {
      id: 1,
      text: '–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã –≥–æ—Ç–æ–≤—ã —É–¥–µ–ª—è—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º—É –∑–∞—Ä–∞–±–æ—Ç–∫—É?',
      options: ['1-2 —á–∞—Å–∞ –≤ –¥–µ–Ω—å', '3-4 —á–∞—Å–∞ –≤ –¥–µ–Ω—å', '–ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å', '–ü–æ–∫–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è']
    },
    {
      id: 2,
      text: '–ö–∞–∫–æ–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ —É –≤–∞—Å –µ—Å—Ç—å?',
      options: ['–ù–∏–∫–∞–∫–æ–≥–æ', '–ü—Ä–æ–±–æ–≤–∞–ª —Ñ—Ä–∏–ª–∞–Ω—Å', '–ï—Å—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –æ–ø—ã—Ç', '–†–∞–±–æ—Ç–∞—é –æ–Ω–ª–∞–π–Ω –¥–∞–≤–Ω–æ']
    },
    {
      id: 3,
      text: '–ß—Ç–æ –¥–ª—è –≤–∞—Å –≤–∞–∂–Ω–µ–µ –≤ —Ä–∞–±–æ—Ç–µ?',
      options: ['–°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥', '–°–≤–æ–±–æ–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫', '–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞', '–†–∞–±–æ—Ç–∞ –∏–∑ –¥–æ–º–∞']
    },
    {
      id: 4,
      text: '–ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?',
      options: ['$300-500/–º–µ—Å', '$500-1000/–º–µ—Å', '$1000-3000/–º–µ—Å', '–ë–æ–ª—å—à–µ $3000/–º–µ—Å']
    },
    {
      id: 5,
      text: '–ì–æ—Ç–æ–≤—ã –ª–∏ –≤—ã –æ–±—É—á–∞—Ç—å—Å—è –Ω–æ–≤–æ–º—É?',
      options: ['–î–∞, –≥–æ—Ç–æ–≤ –≤–∫–ª–∞–¥—ã–≤–∞—Ç—å –≤—Ä–µ–º—è', '–î–∞, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ—Å–ª–æ–∂–Ω–æ', '–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã—Å—Ç—Ä–æ –æ–∫—É–ø–∏—Ç—Å—è', '–•–æ—á—É –≥–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ']
    }
  ]
};

class SurveyApp {
  constructor() {
    this.container = document.getElementById('app');
    
    if (!this.container) {
      console.error('‚ùå Container #app not found!');
      document.body.innerHTML = '<div style="padding:40px;text-align:center;color:#ff6b6b;"><h2>‚ùå –û—à–∏–±–∫–∞</h2><p>Container –Ω–µ –Ω–∞–π–¥–µ–Ω</p></div>';
      return;
    }
    
    console.log('‚úÖ SurveyApp starting...');
    
    this.state = {
      screen: 'loading', // loading, intro, questions, contact, result, share
      survey: null,
      currentQuestion: 0,
      answers: [],
      respondent: null,
      referrer: null,
      referrals: [],
      error: null
    };
    // –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º loading
    this.render();
    // –ü–æ—Ç–æ–º –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    this.init().catch(err => {
      console.error('‚ùå Init error:', err);
      this.state.error = err.message || '–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏';
      this.state.screen = 'error';
      this.render();
    });
  }

  async init() {
    // –ü–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
    const params = new URLSearchParams(window.location.search);
    const surveyId = params.get('s') || 'demo-1';
    const referrerId = params.get('ref');
    
    console.log('üìã Loading survey:', surveyId);
    
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç
    const savedRespondent = localStorage.getItem('survey_respondent_' + surveyId);
    
    try {
      // –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–ø—Ä–æ—Å –∏–∑ Supabase
      let survey = null;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º - —ç—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã–π –æ–ø—Ä–æ—Å –∏–ª–∏ –∏–∑ –±–∞–∑—ã?
      if (surveyId.startsWith('local_')) {
        // –õ–æ–∫–∞–ª—å–Ω—ã–π –æ–ø—Ä–æ—Å –∏–∑ localStorage
        const localSurveys = JSON.parse(localStorage.getItem('cardgift_surveys') || '[]');
        survey = localSurveys.find(s => s.id === surveyId || s.short_code === surveyId);
        console.log('üìã Local survey:', survey ? 'found' : 'not found');
      } else if (surveyId === 'demo-1') {
        // –î–µ–º–æ –æ–ø—Ä–æ—Å
        survey = DEMO_SURVEY;
        console.log('üìã Demo survey loaded');
      } else {
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Supabase - —Å–Ω–∞—á–∞–ª–∞ –ø–æ id, –ø–æ—Ç–æ–º –ø–æ short_code
        console.log('üìã Fetching from Supabase...');
        
        if (!supabaseClient) {
          throw new Error('Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        }
        
        let { data, error } = await supabaseClient
          .from('surveys')
          .select('*')
          .eq('id', surveyId)
          .maybeSingle();
        
        console.log('üìã By ID result:', data ? 'found' : 'not found', error?.message || '');
        
        // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ id, –ø—Ä–æ–±—É–µ–º –ø–æ short_code
        if (!data) {
          const result = await supabaseClient
            .from('surveys')
            .select('*')
            .eq('short_code', surveyId)
            .maybeSingle();
          data = result.data;
          console.log('üìã By short_code result:', data ? 'found' : 'not found');
        }
        
        if (data) {
          survey = data;
          // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
          await supabaseClient
            .from('surveys')
            .update({ views_count: (data.views_count || 0) + 1 })
            .eq('id', data.id);
        }
      }
      
      if (!survey) {
        throw new Error('–û–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω');
      }
      
      // –ü–∞—Ä—Å–∏–º questions –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞
      let questions = survey.questions || [];
      if (typeof questions === 'string') {
        try {
          questions = JSON.parse(questions);
        } catch (e) {
          console.error('Error parsing questions:', e);
          questions = [];
        }
      }
      
      // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –æ–ø—Ä–æ—Å–∞
      this.state.survey = {
        id: survey.id,
        short_code: survey.short_code || null, // –î–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫
        title: survey.title || '–û–ø—Ä–æ—Å',
        description: survey.description || '',
        icon: survey.icon || 'üìã',
        reward_text: survey.reward_text || '–ü–æ–¥–∞—Ä–æ–∫ –∑–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ',
        referral_reward: survey.referral_reward_text || survey.referral_reward || '–ë–æ–Ω—É—Å –∑–∞ –¥—Ä—É–≥–∞',
        questions: questions
      };
      
      console.log('üìã Survey loaded:', this.state.survey.title, 'Questions:', questions.length);
      
      if (!questions || questions.length === 0) {
        throw new Error('–û–ø—Ä–æ—Å –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–æ–ø—Ä–æ—Å–æ–≤');
      }
      
      if (referrerId) {
        this.state.referrer = referrerId;
      }
      
      if (savedRespondent) {
        const resp = JSON.parse(savedRespondent);
        this.state.respondent = resp;
        this.state.screen = 'share';
        await this.loadReferrals();
      } else {
        this.state.screen = 'intro';
      }
    } catch (e) {
      console.error('Survey load error:', e);
      this.state.error = e.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–ø—Ä–æ—Å–∞';
      this.state.screen = 'error';
    }
    
    this.render();
  }

  async loadReferrals() {
    if (!this.state.respondent) return;
    
    try {
      const { data } = await supabaseClient
        .from('survey_respondents')
        .select('id, name, created_at')
        .eq('referrer_id', this.state.respondent.id)
        .order('created_at', { ascending: false });
      
      this.state.referrals = data || [];
    } catch (e) {
      console.error('Error loading referrals:', e);
    }
  }

  async saveRespondent(contactData) {
    const surveyId = this.state.survey.id;
    const survey = this.state.survey;
    
    try {
      // –°–æ–∑–¥–∞—Ç—å —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞
      const respondentData = {
        survey_id: surveyId,
        name: contactData.name,
        contact: contactData.contact,
        contact_type: contactData.type,
        answers: this.state.answers,
        referrer_id: this.state.referrer,
        ip_hash: await this.getIpHash(),
        user_agent: navigator.userAgent.substring(0, 255)
      };
      
      const { data, error } = await supabaseClient
        .from('survey_respondents')
        .insert(respondentData)
        .select()
        .single();
      
      if (error) throw error;
      
      this.state.respondent = data;
      localStorage.setItem('survey_respondent_' + surveyId, JSON.stringify(data));
      
      // –ü–æ–ª—É—á–∞–µ–º owner_gw_id –æ–ø—Ä–æ—Å–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞
      let ownerGwId = survey.owner_gw_id;
      if (!ownerGwId && !surveyId.startsWith('local_') && surveyId !== 'demo-1') {
        const { data: surveyData } = await supabaseClient
          .from('surveys')
          .select('owner_gw_id')
          .eq('id', surveyId)
          .single();
        ownerGwId = surveyData?.owner_gw_id;
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ç–∞–∫—Ç –≤ —Ç–∞–±–ª–∏—Ü—É contacts –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –æ–ø—Ä–æ—Å–∞
      if (ownerGwId) {
        const contactToSave = {
          owner_gw_id: ownerGwId,
          name: contactData.name,
          messenger: contactData.type,
          contact: contactData.contact,
          source: 'survey',
          source_details: JSON.stringify({
            survey_id: surveyId,
            survey_title: survey.title,
            respondent_id: data.id,
            answers_count: this.state.answers.length
          }),
          status: 'new'
        };
        
        await supabaseClient.from('contacts').insert(contactToSave);
        console.log('‚úÖ Contact saved to owner:', ownerGwId);
      }
      
      // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–π –æ–ø—Ä–æ—Å–∞
      if (!surveyId.startsWith('local_') && surveyId !== 'demo-1') {
        await supabaseClient
          .from('surveys')
          .update({ completions_count: (survey.completions_count || 0) + 1 })
          .eq('id', surveyId);
      }
      
      // –û–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ —É –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ
      if (this.state.referrer) {
        try {
          await supabaseClient.rpc('increment_referral_count', { respondent_id: this.state.referrer });
        } catch (rpcError) {
          console.log('RPC not available, skipping referral count update');
        }
      }
      
      return data;
    } catch (e) {
      console.error('Error saving respondent:', e);
      // Fallback - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
      const localData = {
        id: 'local_' + Date.now(),
        ...contactData,
        answers: this.state.answers,
        created_at: new Date().toISOString()
      };
      this.state.respondent = localData;
      localStorage.setItem('survey_respondent_' + surveyId, JSON.stringify(localData));
      return localData;
    }
  }

  async getIpHash() {
    try {
      const resp = await fetch('https://api.ipify.org?format=json');
      const data = await resp.json();
      return btoa(data.ip).substring(0, 20);
    } catch {
      return 'unknown';
    }
  }

  generateShareLink() {
    if (!this.state.respondent) return '';
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ—Ä–æ—Ç–∫—É—é —Å—Å—ã–ª–∫—É /s/{short_code –∏–ª–∏ id}
    const code = this.state.survey.short_code || this.state.survey.id;
    const base = CONFIG.BASE_URL + '/s/' + code;
    return `${base}?ref=${this.state.respondent.id}`;
  }

  copyLink() {
    const link = this.generateShareLink();
    navigator.clipboard.writeText(link).then(() => {
      const btn = document.querySelector('.share-link button');
      if (btn) {
        btn.textContent = '‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
        setTimeout(() => btn.textContent = '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å', 2000);
      }
    });
  }

  shareToTelegram() {
    const link = this.generateShareLink();
    const text = `üéÅ –ü—Ä–æ–π–¥–∏ –æ–ø—Ä–æ—Å "${this.state.survey.title}" –∏ –ø–æ–ª—É—á–∏ –ø–æ–¥–∞—Ä–æ–∫!\n\n`;
    window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`, '_blank');
  }

  shareToWhatsApp() {
    const link = this.generateShareLink();
    const text = `üéÅ –ü—Ä–æ–π–¥–∏ –æ–ø—Ä–æ—Å "${this.state.survey.title}" –∏ –ø–æ–ª—É—á–∏ –ø–æ–¥–∞—Ä–æ–∫!\n${link}`;
    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
  }

  shareToViber() {
    const link = this.generateShareLink();
    const text = `üéÅ –ü—Ä–æ–π–¥–∏ –æ–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏ –ø–æ–¥–∞—Ä–æ–∫! ${link}`;
    window.open(`viber://forward?text=${encodeURIComponent(text)}`, '_blank');
  }

  showConfetti() {
    const container = document.createElement('div');
    container.className = 'confetti';
    document.body.appendChild(container);
    
    const colors = ['#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#96E6A1', '#DDA0DD'];
    
    for (let i = 0; i < 50; i++) {
      const piece = document.createElement('div');
      piece.className = 'confetti-piece';
      piece.style.left = Math.random() * 100 + '%';
      piece.style.background = colors[Math.floor(Math.random() * colors.length)];
      piece.style.animationDelay = Math.random() * 2 + 's';
      piece.style.transform = `rotate(${Math.random() * 360}deg)`;
      container.appendChild(piece);
    }
    
    setTimeout(() => container.remove(), 4000);
  }

  selectAnswer(optionIndex) {
    const q = this.state.survey.questions[this.state.currentQuestion];
    this.state.answers[this.state.currentQuestion] = {
      question_id: q.id,
      question: q.text,
      answer: q.options[optionIndex],
      answer_index: optionIndex
    };
    this.render();
  }

  nextQuestion() {
    if (this.state.currentQuestion < this.state.survey.questions.length - 1) {
      this.state.currentQuestion++;
      this.render();
    } else {
      this.state.screen = 'contact';
      this.render();
    }
  }

  prevQuestion() {
    if (this.state.currentQuestion > 0) {
      this.state.currentQuestion--;
      this.render();
    }
  }

  async submitContact(e) {
    e.preventDefault();
    const form = e.target;
    const name = form.name.value.trim();
    const contact = form.contact.value.trim();
    const type = form.contact_type.value;
    
    if (!name || !contact) {
      this.state.error = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
      this.render();
      return;
    }
    
    this.state.screen = 'saving';
    this.render();
    
    await this.saveRespondent({ name, contact, type });
    
    this.showConfetti();
    this.state.screen = 'result';
    this.render();
  }

  goToShare() {
    this.state.screen = 'share';
    this.render();
  }

  render() {
    const { screen, survey, currentQuestion, answers, respondent, referrals, error } = this.state;
    
    console.log('üé® Render screen:', screen, 'Survey:', survey ? survey.title : 'null');
    
    let html = '';
    
    // –ó–∞—â–∏—Ç–∞ –æ—Ç null survey –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –¥–∞–Ω–Ω—ã–µ
    if (!survey && ['intro', 'questions', 'contact', 'result', 'share'].includes(screen)) {
      html = `
        <div class="card loading">
          <div class="spinner"></div>
          <p>–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø—Ä–æ—Å–∞...</p>
        </div>
      `;
      this.container.innerHTML = html;
      return;
    }
    
    switch (screen) {
      case 'loading':
        html = `
          <div class="card loading">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø—Ä–æ—Å–∞...</p>
            <p style="font-size:11px;color:#666;margin-top:10px;">ID: ${new URLSearchParams(window.location.search).get('s') || 'demo-1'}</p>
          </div>
        `;
        break;
        
      case 'intro':
        html = `
          <div class="card">
            <div class="header">
              <span class="header-icon">${survey.icon}</span>
              <h1>${survey.title}</h1>
              <p>${survey.description}</p>
            </div>
            
            <div class="gift-banner">
              <div class="gift-banner-icon">üéÅ</div>
              <h3>–ü–æ–ª—É—á–∏—Ç–µ –ø–æ–¥–∞—Ä–æ–∫!</h3>
              <p>${survey.reward_text}</p>
            </div>
            
            <div style="margin-bottom:20px;color:var(--text-muted);font-size:13px;text-align:center">
              <p>üìã ${survey.questions.length} –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Ä¢ ‚è±Ô∏è ~2 –º–∏–Ω—É—Ç—ã</p>
            </div>
            
            <button class="btn btn-primary" onclick="app.state.screen='questions';app.render()">
              üöÄ –ù–∞—á–∞—Ç—å –æ–ø—Ä–æ—Å
            </button>
            
            ${this.state.referrer ? `
              <div style="margin-top:15px;text-align:center;color:var(--text-muted);font-size:12px">
                üë§ –í–∞—Å –ø—Ä–∏–≥–ª–∞—Å–∏–ª –¥—Ä—É–≥
              </div>
            ` : ''}
          </div>
        `;
        break;
        
      case 'questions':
        const q = survey.questions[currentQuestion];
        const progress = ((currentQuestion + 1) / survey.questions.length) * 100;
        const currentAnswer = answers[currentQuestion];
        
        html = `
          <div class="card">
            <div class="progress-container">
              <div class="progress-text">
                <span>–í–æ–ø—Ä–æ—Å ${currentQuestion + 1} –∏–∑ ${survey.questions.length}</span>
                <span>${Math.round(progress)}%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width:${progress}%"></div>
              </div>
            </div>
            
            <div class="question">
              <div class="question-num">–í–æ–ø—Ä–æ—Å ${currentQuestion + 1}</div>
              <div class="question-title">${q.text}</div>
              
              <div class="options">
                ${q.options.map((opt, i) => `
                  <div class="option ${currentAnswer?.answer_index === i ? 'selected' : ''}" onclick="app.selectAnswer(${i})">
                    <div class="option-radio"></div>
                    <div class="option-text">${opt}</div>
                  </div>
                `).join('')}
              </div>
            </div>
            
            <div style="display:flex;gap:10px">
              ${currentQuestion > 0 ? `
                <button class="btn btn-secondary" style="flex:1" onclick="app.prevQuestion()">
                  ‚Üê –ù–∞–∑–∞–¥
                </button>
              ` : ''}
              <button class="btn btn-primary" style="flex:2" onclick="app.nextQuestion()" ${!currentAnswer ? 'disabled' : ''}>
                ${currentQuestion < survey.questions.length - 1 ? '–î–∞–ª–µ–µ ‚Üí' : '–ó–∞–≤–µ—Ä—à–∏—Ç—å ‚úì'}
              </button>
            </div>
          </div>
        `;
        break;
        
      case 'contact':
        html = `
          <div class="card">
            <div class="header">
              <span class="header-icon">üéâ</span>
              <h1>–û—Ç–ª–∏—á–Ω–æ!</h1>
              <p>–û—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∞—Ä–∫–∞</p>
            </div>
            
            ${error ? `<div class="error-msg">${error}</div>` : ''}
            
            <form onsubmit="app.submitContact(event)">
              <div class="input-group">
                <label>–í–∞—à–µ –∏–º—è</label>
                <input type="text" name="name" class="input" placeholder="–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?" required>
              </div>
              
              <div class="input-group">
                <label>–ö—É–¥–∞ –ø—Ä–∏—Å–ª–∞—Ç—å –ø–æ–¥–∞—Ä–æ–∫?</label>
                <select name="contact_type" class="input" style="margin-bottom:10px">
                  <option value="telegram">Telegram</option>
                  <option value="email">Email</option>
                  <option value="phone">–¢–µ–ª–µ—Ñ–æ–Ω</option>
                  <option value="whatsapp">WhatsApp</option>
                </select>
                <input type="text" name="contact" class="input" placeholder="@username, email –∏–ª–∏ –Ω–æ–º–µ—Ä" required>
              </div>
              
              <button type="submit" class="btn btn-green">
                üéÅ –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫
              </button>
            </form>
            
            <div style="margin-top:15px;text-align:center;color:var(--text-muted);font-size:11px">
              üîí –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ –Ω–µ –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º
            </div>
          </div>
        `;
        break;
        
      case 'saving':
        html = `
          <div class="card loading">
            <div class="spinner"></div>
            <p>–°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ...</p>
          </div>
        `;
        break;
        
      case 'result':
        html = `
          <div class="card">
            <div class="header">
              <div class="success-animation">üéâ</div>
              <h1>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h1>
              <p>–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ –æ–ø—Ä–æ—Å</p>
            </div>
            
            <div class="gift-banner">
              <div class="gift-banner-icon">üéÅ</div>
              <h3>–í–∞—à –ø–æ–¥–∞—Ä–æ–∫ –≥–æ—Ç–æ–≤!</h3>
              <p>${survey.reward_text}</p>
            </div>
            
            <div style="background:var(--bg-lighter);border-radius:12px;padding:20px;text-align:center;margin-bottom:20px">
              <div style="font-size:14px;color:var(--text-muted);margin-bottom:10px">–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID</div>
              <div style="font-size:24px;font-weight:700;color:var(--gold);font-family:monospace">
                #${respondent.id.toString().slice(-6).toUpperCase()}
              </div>
            </div>
            
            <button class="btn btn-primary" onclick="app.goToShare()">
              üì§ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å
            </button>
            
            <div style="margin-top:15px;text-align:center;color:var(--text-muted);font-size:12px">
              üí° –ó–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞ ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å!
            </div>
          </div>
        `;
        break;
        
      case 'share':
        const shareLink = this.generateShareLink();
        
        html = `
          <div class="card">
            <div class="share-section">
              <div style="font-size:50px;margin-bottom:15px">üéÅ</div>
              <div class="share-title">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π!</div>
              <div class="share-subtitle">${survey.referral_reward}</div>
              
              <div class="share-link">
                <input type="text" value="${shareLink}" readonly>
                <button onclick="app.copyLink()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
              </div>
              
              <div class="share-buttons">
                <button class="share-btn telegram" onclick="app.shareToTelegram()" title="Telegram">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.27-.02-.12.03-1.99 1.27-5.62 3.72-.53.36-1.01.54-1.44.53-.47-.01-1.38-.26-2.06-.48-.83-.27-1.49-.42-1.43-.88.03-.24.37-.49 1.02-.74 3.99-1.74 6.65-2.89 7.99-3.45 3.81-1.58 4.6-1.86 5.12-1.87.11 0 .37.03.53.17.14.12.18.28.2.45-.01.06.01.24 0 .38z"/></svg>
                </button>
                <button class="share-btn whatsapp" onclick="app.shareToWhatsApp()" title="WhatsApp">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
                </button>
                <button class="share-btn viber" onclick="app.shareToViber()" title="Viber">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12.031 1.278c-5.539 0-10.031 4.492-10.031 10.031 0 1.86.509 3.602 1.395 5.096l-1.465 5.345 5.484-1.439c1.433.787 3.07 1.235 4.617 1.235 5.539 0 10.031-4.492 10.031-10.031s-4.492-10.237-10.031-10.237zm5.969 14.344c-.234.656-1.359 1.289-1.875 1.328-.469.031-.918.211-3.086-.645-2.621-1.035-4.285-3.707-4.414-3.879-.129-.172-1.055-1.406-1.055-2.68s.668-1.902.906-2.164c.238-.262.52-.328.691-.328.172 0 .344.004.496.012.156.008.371-.059.578.441.215.52.73 1.781.793 1.91.066.129.109.281.023.453-.086.172-.129.281-.258.434-.129.152-.273.34-.391.457-.129.129-.262.27-.113.527.152.262.668 1.102 1.434 1.785.984.879 1.816 1.152 2.074 1.281.258.129.41.109.559-.066.152-.172.648-.754.82-1.016.172-.262.348-.215.582-.129.238.086 1.496.707 1.754.836.258.129.43.195.492.301.066.109.066.629-.168 1.142z"/></svg>
                </button>
                <button class="share-btn copy" onclick="app.copyLink()" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å">
                  üìã
                </button>
              </div>
            </div>
            
            <div class="stats-row">
              <div class="stat-item">
                <div class="stat-value">${referrals.length}</div>
                <div class="stat-label">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ</div>
              </div>
              <div class="stat-item">
                <div class="stat-value">${referrals.length * 10}</div>
                <div class="stat-label">–ë–æ–Ω—É—Å–æ–≤</div>
              </div>
            </div>
            
            ${referrals.length > 0 ? `
              <div class="referral-list">
                <h3 style="font-size:14px;color:var(--text-muted);margin-bottom:15px">–í–∞—à–∏ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–µ:</h3>
                ${referrals.map(r => `
                  <div class="referral-item">
                    <div class="referral-avatar">${r.name.charAt(0).toUpperCase()}</div>
                    <div class="referral-info">
                      <div class="referral-name">${r.name}</div>
                      <div class="referral-date">${new Date(r.created_at).toLocaleDateString('ru')}</div>
                    </div>
                    <div class="referral-status">‚úÖ</div>
                  </div>
                `).join('')}
              </div>
            ` : `
              <div style="text-align:center;padding:30px;color:var(--text-muted)">
                <div style="font-size:40px;margin-bottom:10px">üë•</div>
                <p>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∏—Ç–µ –±–æ–Ω—É—Å—ã!</p>
              </div>
            `}
            
            ${referrals.length >= 3 ? `
              <div class="reward-card">
                <h3>üèÜ –ù–∞–≥—Ä–∞–¥–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞!</h3>
                <p>–í—ã –ø—Ä–∏–≥–ª–∞—Å–∏–ª–∏ 3+ –¥—Ä—É–∑–µ–π. –í–∞—à –±–æ–Ω—É—Å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!</p>
              </div>
            ` : `
              <div style="margin-top:20px;text-align:center;color:var(--text-muted);font-size:12px">
                üéØ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –µ—â—ë ${3 - referrals.length} –¥—Ä—É–∑–µ–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã
              </div>
            `}
          </div>
        `;
        break;
        
      case 'error':
        html = `
          <div class="card">
            <div class="header">
              <span class="header-icon">‚ùå</span>
              <h1>–û—à–∏–±–∫–∞</h1>
              <p>${error}</p>
            </div>
            <button class="btn btn-primary" onclick="location.reload()">
              üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
            </button>
          </div>
        `;
        break;
        
      default:
        console.error('Unknown screen:', screen);
        html = `
          <div class="card">
            <div class="header">
              <span class="header-icon">‚ö†Ô∏è</span>
              <h1>–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
              <p>–ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ</p>
            </div>
          </div>
        `;
    }
    
    this.container.innerHTML = html;
  }
}

const app = new SurveyApp();
</script>
</body>
</html>
