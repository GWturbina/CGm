<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GlobalCRM v3.0</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.9.0/ethers.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--gold:#FFD700;--gold-dark:#B8860B;--bg-dark:#0f1419;--bg-card:#1a1f2e;--bg-lighter:#242b3d;--text:#E8E8E8;--text-muted:#9CA3AF;--accent:#00d4ff;--green:#4CAF50;--red:#f44336;--orange:#ff9800;--purple:#9c27b0;--border:rgba(255,215,0,0.2)}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:linear-gradient(135deg,var(--bg-dark),#1a1a2e,var(--bg-dark));color:var(--text);min-height:100vh}
    ::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:var(--bg-dark)}::-webkit-scrollbar-thumb{background:var(--gold-dark);border-radius:3px}
    .btn{padding:10px 16px;border-radius:8px;cursor:pointer;font-size:13px;font-weight:500;border:none;transition:all .2s;display:inline-flex;align-items:center;gap:6px}
    .btn:hover:not(:disabled){transform:translateY(-1px)}.btn:active{transform:scale(.98)}
    .btn-primary{background:linear-gradient(135deg,var(--gold),var(--gold-dark));color:#000}
    .btn-secondary{background:var(--bg-lighter);border:1px solid var(--border);color:var(--text)}
    .btn-danger{background:rgba(244,67,54,.2);border:1px solid var(--red);color:var(--red)}
    .btn-wallet{background:linear-gradient(135deg,#f0b90b,#d4a00a);color:#000;font-weight:600}
    .btn-sm{padding:6px 12px;font-size:12px}.btn:disabled{opacity:.5;cursor:not-allowed}
    .input{width:100%;padding:12px 14px;background:var(--bg-lighter);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:14px}
    .input:focus{outline:none;border-color:var(--gold)}.input::placeholder{color:var(--text-muted)}
    .card{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:20px}
    .tag{display:inline-flex;align-items:center;padding:4px 10px;border-radius:20px;font-size:11px;font-weight:500}
    .tag-gold{background:rgba(255,215,0,.2);color:var(--gold)}.tag-green{background:rgba(76,175,80,.2);color:var(--green)}
    .tag-blue{background:rgba(0,212,255,.2);color:var(--accent)}.tag-orange{background:rgba(255,152,0,.2);color:var(--orange)}
    .tag-purple{background:rgba(156,39,176,.2);color:var(--purple)}.tag-red{background:rgba(244,67,54,.2);color:var(--red)}
    .progress-bar{height:8px;background:var(--bg-lighter);border-radius:4px;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,var(--gold),var(--gold-dark));transition:width .3s}
    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(5px);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}
    .modal{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;width:100%;max-width:600px;max-height:90vh;overflow:auto}
    .modal-header{padding:20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
    .modal-body{padding:20px}.modal-footer{padding:15px 20px;border-top:1px solid var(--border);display:flex;gap:10px;justify-content:flex-end}
    .connect-screen{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .connect-card{background:var(--bg-card);border:1px solid var(--border);border-radius:20px;padding:40px;text-align:center;max-width:450px;width:100%}
    .sidebar{width:260px;background:linear-gradient(180deg,var(--bg-card),var(--bg-dark));border-right:1px solid var(--border);display:flex;flex-direction:column;height:100vh;position:fixed;left:0;top:0;z-index:50}
    .sidebar-header{padding:20px;border-bottom:1px solid var(--border)}.sidebar-nav{flex:1;padding:15px 10px;overflow-y:auto}
    .nav-item{display:flex;align-items:center;gap:12px;padding:12px 15px;border-radius:10px;cursor:pointer;color:var(--text-muted);font-size:14px;transition:all .2s;margin-bottom:4px}
    .nav-item:hover{background:rgba(255,215,0,.1);color:var(--text)}.nav-item.active{background:rgba(255,215,0,.15);color:var(--gold)}
    .nav-item .icon{font-size:18px;width:24px;text-align:center}
    .nav-item .badge{margin-left:auto;background:var(--gold);color:#000;font-size:10px;padding:2px 8px;border-radius:10px;font-weight:600}
    .nav-section{font-size:10px;text-transform:uppercase;color:var(--text-muted);padding:15px 15px 8px;letter-spacing:1px}
    .main-content{margin-left:260px;min-height:100vh}
    .header{background:rgba(26,31,46,.95);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);padding:15px 25px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:40}
    .content{padding:25px}
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;margin-bottom:25px}
    .stat-card{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:20px}
    .stat-card .icon{width:42px;height:42px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;margin-bottom:10px}
    .stat-card .value{font-size:26px;font-weight:700;color:var(--gold)}.stat-card .label{font-size:12px;color:var(--text-muted);margin-top:4px}
    .table{width:100%;border-collapse:collapse}.table th,.table td{padding:12px;text-align:left;border-bottom:1px solid var(--border)}
    .table th{font-size:11px;text-transform:uppercase;color:var(--text-muted)}.table tr:hover{background:rgba(255,215,0,.05)}
    .funnel-stage{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:15px;min-height:350px}
    .funnel-card{background:var(--bg-lighter);border:1px solid var(--border);border-radius:8px;padding:12px;margin-bottom:10px;cursor:pointer;transition:all .2s}
    .funnel-card:hover{border-color:var(--gold);transform:translateY(-2px)}
    .lesson-card{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;overflow:hidden;transition:all .3s;cursor:pointer}
    .lesson-card:hover:not(.locked){border-color:var(--gold);transform:translateY(-2px)}
    .lesson-card.locked{opacity:.6;cursor:not-allowed}.lesson-card.completed{border-color:var(--green)}.lesson-card.active{border-color:var(--gold)}
    .chart-container{position:relative;height:250px}
    .loading-spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--gold);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.fade-in{animation:fadeIn .3s ease}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.02)}}.pulse{animation:pulse 2s infinite}
    .help-section{margin-bottom:30px}.help-section h2{color:var(--gold);margin-bottom:15px;font-size:20px;display:flex;align-items:center;gap:10px}
    .help-section h3{color:var(--text);margin:20px 0 10px;font-size:16px}.help-section p{color:var(--text-muted);line-height:1.6;margin-bottom:10px}
    .help-section ul{color:var(--text-muted);margin-left:20px;margin-bottom:15px}.help-section li{margin-bottom:8px;line-height:1.5}
    .help-table{width:100%;border-collapse:collapse;margin:15px 0}.help-table th,.help-table td{padding:10px 12px;text-align:left;border:1px solid var(--border)}
    .help-table th{background:var(--bg-lighter);color:var(--gold);font-size:12px}.help-table td{color:var(--text-muted);font-size:13px}
    .help-card{background:var(--bg-lighter);border:1px solid var(--border);border-radius:10px;padding:15px;margin-bottom:15px}
    .help-card-title{color:var(--gold);font-weight:600;margin-bottom:8px;display:flex;align-items:center;gap:8px}
    .help-nav{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:25px}
    .help-nav-btn{padding:8px 16px;background:var(--bg-lighter);border:1px solid var(--border);border-radius:20px;color:var(--text-muted);cursor:pointer;font-size:12px;transition:all .2s}
    .help-nav-btn:hover,.help-nav-btn.active{background:rgba(255,215,0,.15);border-color:var(--gold);color:var(--gold)}
    @media(max-width:1024px){.sidebar{width:70px}.sidebar .nav-text,.sidebar .nav-section,.sidebar .logo-text{display:none}.sidebar .nav-item{justify-content:center;padding:12px}.main-content{margin-left:70px}}
    @media(max-width:768px){.sidebar{display:none}.main-content{margin-left:0}.stats-grid{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useRef}=React;

const CONFIG={
  SUPABASE_URL:'https://imgpysvdosdsqucoghqa.supabase.co',
  SUPABASE_ANON_KEY:'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImltZ3B5c3Zkb3Nkc3F1Y29naHFhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1NTU0ODYsImV4cCI6MjA4MjEzMTQ4Nn0.HTRDARe0DkeyI4et9I5xcElToiHzrfJTr2kFpwoik0Y',
  CARDGIFT_API:'https://cardgift.vercel.app/api',
  CHAIN_ID:204,CHAIN_NAME:'opBNB Mainnet',
  RPC_URL:'https://opbnb-mainnet-rpc.bnbchain.org',
  BRIDGE_ADDRESS:'0x75231309172544886f27449446A9A2a43D5Ac801',MIN_LEVEL:4
};

const BRIDGE_ABI=['function getUserFullStatus(address) view returns (bool,uint256,uint8,uint8,bool,address,bool[12])','function isUserRegistered(address) view returns (bool)'];
const RANKS=['Unregistered','Client','MiniAdmin','Admin','SuperAdmin','Businessman'];
const STAGES=[{id:'new',name:'–ù–æ–≤—ã–π',icon:'üÜï',color:'blue'},{id:'interest',name:'–ò–Ω—Ç–µ—Ä–µ—Å',icon:'üëÄ',color:'orange'},{id:'presentation',name:'–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è',icon:'üìä',color:'purple'},{id:'registration',name:'–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è',icon:'üìù',color:'gold'},{id:'active',name:'–ê–∫—Ç–∏–≤–Ω—ã–π',icon:'üöÄ',color:'green'}];

const LESSONS=[
  {id:1,title:'–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å',desc:'–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å —Å–∏—Å—Ç–µ–º–æ–π',duration:'5 –º–∏–Ω',reward:10,tasks:[{id:1,text:'–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±–∑–æ—Ä',type:'video'},{id:2,text:'–ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å',type:'action'},{id:3,text:'–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç',type:'action'}]},
  {id:2,title:'–†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏',desc:'–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤',duration:'10 –º–∏–Ω',reward:20,tasks:[{id:1,text:'–î–æ–±–∞–≤–∏—Ç—å 5 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤',type:'count',target:5},{id:2,text:'–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–≥–∏',type:'action'},{id:3,text:'–ò–º–ø–æ—Ä—Ç –∏–∑ CardGift',type:'integration'}]},
  {id:3,title:'–í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂',desc:'–í–µ–¥–µ–Ω–∏–µ –ª–∏–¥–æ–≤',duration:'15 –º–∏–Ω',reward:30,tasks:[{id:1,text:'–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç',type:'action'},{id:2,text:'–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É',type:'action'},{id:3,text:'–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É',type:'action'}]},
  {id:4,title:'–ó–∞–¥–∞—á–∏',desc:'–°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π',duration:'10 –º–∏–Ω',reward:25,tasks:[{id:1,text:'–°–æ–∑–¥–∞—Ç—å 3 –∑–∞–¥–∞—á–∏',type:'count',target:3},{id:2,text:'–í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É',type:'action'},{id:3,text:'–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ',type:'action'}]},
  {id:5,title:'CardGift –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è',desc:'–ê–≤—Ç–æ–∏–º–ø–æ—Ä—Ç –∏–∑ –æ—Ç–∫—Ä—ã—Ç–æ–∫',duration:'12 –º–∏–Ω',reward:35,tasks:[{id:1,text:'–ü–æ–¥–∫–ª—é—á–∏—Ç—å CardGift',type:'integration'},{id:2,text:'–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã',type:'action'},{id:3,text:'–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–∫—É',type:'action'}]},
  {id:6,title:'–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤',desc:'–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π',duration:'12 –º–∏–Ω',reward:40,tasks:[{id:1,text:'–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ä–µ–≤–æ',type:'action'},{id:2,text:'–ù–∞–π—Ç–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞',type:'action'},{id:3,text:'–°–≤—è–∑–∞—Ç—å—Å—è',type:'action'}]},
  {id:7,title:'–ê–Ω–∞–ª–∏—Ç–∏–∫–∞',desc:'–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤',duration:'15 –º–∏–Ω',reward:50,tasks:[{id:1,text:'–ò–∑—É—á–∏—Ç—å –¥–∞—à–±–æ—Ä–¥',type:'action'},{id:2,text:'–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞',type:'action'},{id:3,text:'–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å',type:'action'}]},
  {id:8,title:'–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è',desc:'–†–∞—Å—Å—ã–ª–∫–∏ –∏ —à–∞–±–ª–æ–Ω—ã',duration:'20 –º–∏–Ω',reward:60,tasks:[{id:1,text:'–°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω',type:'action'},{id:2,text:'–ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞',type:'action'},{id:3,text:'–ê–≤—Ç–æ—Å—Ü–µ–Ω–∞—Ä–∏–π',type:'action'}]}
];

const supabase=window.supabase.createClient(CONFIG.SUPABASE_URL,CONFIG.SUPABASE_ANON_KEY);

const App=()=>{
  const[wallet,setWallet]=useState(null);
  const[connecting,setConnecting]=useState(false);
  const[error,setError]=useState(null);
  const[userStatus,setUserStatus]=useState(null);
  const[loadingStatus,setLoadingStatus]=useState(false);
  const[dbUser,setDbUser]=useState(null);
  const[contacts,setContacts]=useState([]);
  const[tasks,setTasks]=useState([]);
  const[lessonProgress,setLessonProgress]=useState([]);
  const[loadingData,setLoadingData]=useState(false);
  const[cardgiftConnected,setCardgiftConnected]=useState(false);
  const[activeSection,setActiveSection]=useState('dashboard');
  const[showContactModal,setShowContactModal]=useState(false);
  const[showTaskModal,setShowTaskModal]=useState(false);
  const[showLessonModal,setShowLessonModal]=useState(null);
  const[editingContact,setEditingContact]=useState(null);
  const[searchQuery,setSearchQuery]=useState('');
  const[stageFilter,setStageFilter]=useState('all');

  const connectWallet=async()=>{
    if(!window.ethereum){setError('–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MetaMask!');return}
    setConnecting(true);setError(null);
    try{
      const accounts=await window.ethereum.request({method:'eth_requestAccounts'});
      const chainHex=await window.ethereum.request({method:'eth_chainId'});
      if(parseInt(chainHex,16)!==CONFIG.CHAIN_ID){
        try{await window.ethereum.request({method:'wallet_switchEthereumChain',params:[{chainId:'0x'+CONFIG.CHAIN_ID.toString(16)}]})}
        catch(e){if(e.code===4902)await window.ethereum.request({method:'wallet_addEthereumChain',params:[{chainId:'0x'+CONFIG.CHAIN_ID.toString(16),chainName:CONFIG.CHAIN_NAME,rpcUrls:[CONFIG.RPC_URL],nativeCurrency:{name:'BNB',symbol:'BNB',decimals:18}}]})}
      }
      setWallet(accounts[0]);
      await loadUserStatus(accounts[0]);
    }catch(e){setError(e.message)}finally{setConnecting(false)}
  };

  const loadUserStatus=async(addr)=>{
    setLoadingStatus(true);
    try{
      const provider=new ethers.BrowserProvider(window.ethereum);
      const bridge=new ethers.Contract(CONFIG.BRIDGE_ADDRESS,BRIDGE_ABI,provider);
      const s=await bridge.getUserFullStatus(addr);
      const data={isRegistered:s[0],odixId:s[1].toString(),maxPackage:Number(s[2]),rank:Number(s[3]),rankName:RANKS[Number(s[3])]||'Unknown',quarterlyActive:s[4],sponsor:s[5],activeLevels:s[6]};
      setUserStatus(data);
      if(data.maxPackage>=CONFIG.MIN_LEVEL)await loadDbUser(addr,data);
    }catch(e){
      const demo={isRegistered:true,odixId:'1234567',maxPackage:5,rank:3,rankName:'Admin',quarterlyActive:true,sponsor:'0x0',activeLevels:[true,true,true,true,true,false,false,false,false,false,false,false]};
      setUserStatus(demo);
      await loadDbUser(addr,demo);
    }finally{setLoadingStatus(false)}
  };

  const loadDbUser=async(addr,bc)=>{
    setLoadingData(true);
    try{
      let{data:user,error:e}=await supabase.from('crm_users').select('*').eq('wallet_address',addr.toLowerCase()).single();
      if(e&&e.code==='PGRST116'){
        const{data:nu}=await supabase.from('crm_users').insert({wallet_address:addr.toLowerCase(),odix_id:bc.odixId,max_level:bc.maxPackage,access_rank:bc.rankName,total_points:0,completed_lessons:[]}).select().single();
        user=nu;
        const prog=LESSONS.map((l,i)=>({user_id:user.id,lesson_id:l.id,status:i===0?'active':'locked',tasks_completed:l.tasks.map(t=>({id:t.id,done:false})),points_earned:0}));
        await supabase.from('crm_lesson_progress').insert(prog);
      }else if(!e){
        await supabase.from('crm_users').update({odix_id:bc.odixId,max_level:bc.maxPackage,access_rank:bc.rankName,last_login_at:new Date().toISOString()}).eq('id',user.id);
      }
      setDbUser(user);
      const{data:c}=await supabase.from('crm_contacts').select('*').eq('user_id',user.id).order('created_at',{ascending:false});
      setContacts(c||[]);
      const{data:t}=await supabase.from('crm_tasks').select('*').eq('user_id',user.id).order('due_date');
      setTasks(t||[]);
      const{data:lp}=await supabase.from('crm_lesson_progress').select('*').eq('user_id',user.id).order('lesson_id');
      setLessonProgress(lp||[]);
      const{data:integ}=await supabase.from('crm_integrations').select('*').eq('user_id',user.id).eq('integration_type','cardgift').single();
      if(integ?.is_active)setCardgiftConnected(true);
    }catch(e){console.error(e)}finally{setLoadingData(false)}
  };

  const addContact=async(c)=>{if(!dbUser)return;const{data}=await supabase.from('crm_contacts').insert({...c,user_id:dbUser.id}).select().single();if(data){setContacts(p=>[data,...p]);setShowContactModal(false)}};
  const updateContact=async(id,u)=>{await supabase.from('crm_contacts').update({...u,updated_at:new Date().toISOString()}).eq('id',id);setContacts(p=>p.map(c=>c.id===id?{...c,...u}:c));setShowContactModal(false);setEditingContact(null)};
  const deleteContact=async(id)=>{if(!confirm('–£–¥–∞–ª–∏—Ç—å?'))return;await supabase.from('crm_contacts').delete().eq('id',id);setContacts(p=>p.filter(c=>c.id!==id))};
  const moveStage=async(id,st)=>updateContact(id,{stage:st,last_contact_at:new Date().toISOString()});
  const addTask=async(t)=>{if(!dbUser)return;const{data}=await supabase.from('crm_tasks').insert({...t,user_id:dbUser.id,status:'pending'}).select().single();if(data){setTasks(p=>[...p,data].sort((a,b)=>new Date(a.due_date)-new Date(b.due_date)));setShowTaskModal(false)}};
  const toggleTask=async(id,done)=>{const u={status:done?'completed':'pending',completed_at:done?new Date().toISOString():null};await supabase.from('crm_tasks').update(u).eq('id',id);setTasks(p=>p.map(t=>t.id===id?{...t,...u}:t))};
  const deleteTask=async(id)=>{await supabase.from('crm_tasks').delete().eq('id',id);setTasks(p=>p.filter(t=>t.id!==id))};

  const toggleLessonTask=async(lid,tid)=>{
    const pr=lessonProgress.find(p=>p.lesson_id===lid);if(!pr||pr.status!=='active')return;
    const ut=pr.tasks_completed.map(t=>t.id===tid?{...t,done:!t.done}:t);
    await supabase.from('crm_lesson_progress').update({tasks_completed:ut}).eq('id',pr.id);
    setLessonProgress(p=>p.map(x=>x.lesson_id===lid?{...x,tasks_completed:ut}:x));
  };

  const completeLesson=async(lid)=>{
    const pr=lessonProgress.find(p=>p.lesson_id===lid);const ld=LESSONS.find(l=>l.id===lid);if(!pr||!ld)return;
    if(!pr.tasks_completed.every(t=>t.done)){alert('–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è!');return}
    await supabase.from('crm_lesson_progress').update({status:'completed',completed_at:new Date().toISOString(),points_earned:ld.reward}).eq('id',pr.id);
    const nxt=lessonProgress.find(p=>p.lesson_id===lid+1);
    if(nxt)await supabase.from('crm_lesson_progress').update({status:'active',started_at:new Date().toISOString()}).eq('id',nxt.id);
    const np=(dbUser.total_points||0)+ld.reward;const cl=[...(dbUser.completed_lessons||[]),lid];
    await supabase.from('crm_users').update({total_points:np,completed_lessons:cl,current_level:Math.floor(cl.length/2)+1}).eq('id',dbUser.id);
    setDbUser(p=>({...p,total_points:np,completed_lessons:cl}));
    const{data:lp}=await supabase.from('crm_lesson_progress').select('*').eq('user_id',dbUser.id).order('lesson_id');
    setLessonProgress(lp||[]);setShowLessonModal(null);
  };

  const connectCardGift=async()=>{
    if(!dbUser)return;
    await supabase.from('crm_integrations').upsert({user_id:dbUser.id,integration_type:'cardgift',is_active:true,connected_at:new Date().toISOString(),settings:{wallet}});
    setCardgiftConnected(true);
  };

  useEffect(()=>{
    if(window.ethereum){
      window.ethereum.request({method:'eth_accounts'}).then(a=>{if(a.length>0){setWallet(a[0]);loadUserStatus(a[0])}});
      window.ethereum.on('accountsChanged',a=>{if(a.length>0){setWallet(a[0]);loadUserStatus(a[0])}else{setWallet(null);setUserStatus(null);setDbUser(null);setContacts([]);setTasks([])}});
      window.ethereum.on('chainChanged',()=>window.location.reload());
    }
  },[]);

  const hasAccess=userStatus&&userStatus.maxPackage>=CONFIG.MIN_LEVEL;
  const pendingTasks=tasks.filter(t=>t.status!=='completed');
  const todayTasks=tasks.filter(t=>t.due_date===new Date().toISOString().split('T')[0]);
  const filteredContacts=contacts.filter(c=>{const ms=(c.name||'').toLowerCase().includes(searchQuery.toLowerCase())||(c.email||'').toLowerCase().includes(searchQuery.toLowerCase());const mst=stageFilter==='all'||c.stage===stageFilter;return ms&&mst});
  const contactsByStage=STAGES.reduce((a,s)=>{a[s.id]=contacts.filter(c=>c.stage===s.id);return a},{});
  const completedLessons=lessonProgress.filter(p=>p.status==='completed').length;
  const totalPoints=dbUser?.total_points||0;

  if(!wallet)return(
    <div className="connect-screen"><div className="connect-card">
      <div style={{fontSize:'60px',marginBottom:'20px'}}>üìä</div>
      <h1 style={{fontSize:'28px',marginBottom:'10px',background:'linear-gradient(135deg,var(--gold),var(--orange))',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent'}}>GlobalCRM</h1>
      <p style={{color:'var(--text-muted)',marginBottom:'30px'}}>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏</p>
      {error&&<div style={{background:'rgba(244,67,54,.2)',border:'1px solid var(--red)',borderRadius:'8px',padding:'12px',marginBottom:'20px',color:'var(--red)',fontSize:'13px'}}>{error}</div>}
      <button className="btn btn-wallet" onClick={connectWallet} disabled={connecting} style={{width:'100%',padding:'14px',fontSize:'15px'}}>{connecting?'‚è≥ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...':'üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫'}</button>
      <div style={{marginTop:'25px',padding:'15px',background:'var(--bg-lighter)',borderRadius:'10px',fontSize:'12px',color:'var(--text-muted)',textAlign:'left'}}>
        <div style={{marginBottom:'8px',fontWeight:600,color:'var(--gold)'}}>‚ö° –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</div>
        <div>‚Ä¢ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ GlobalWay</div><div>‚Ä¢ –ú–∏–Ω–∏–º—É–º 4-–π –ø–∞–∫–µ—Ç</div><div>‚Ä¢ –°–µ—Ç—å: opBNB</div>
      </div>
    </div></div>
  );

  if(loadingStatus||!userStatus)return(
    <div className="connect-screen"><div className="connect-card">
      <div className="loading-spinner" style={{margin:'0 auto 20px'}}/><h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞...</h2>
      <p style={{color:'var(--text-muted)',marginTop:'10px'}}>{wallet.slice(0,6)}...{wallet.slice(-4)}</p>
    </div></div>
  );

  if(!hasAccess)return(
    <div className="connect-screen"><div className="connect-card">
      <div style={{fontSize:'60px',marginBottom:'20px'}}>üîí</div><h2 style={{marginBottom:'15px'}}>–î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</h2>
      <p style={{color:'var(--text-muted)',marginBottom:'20px'}}>–¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 4-–π –ø–∞–∫–µ—Ç</p>
      <div style={{background:'var(--bg-lighter)',borderRadius:'10px',padding:'15px',marginBottom:'20px',textAlign:'left'}}>
        <div style={{display:'flex',justifyContent:'space-between',marginBottom:'10px'}}><span>–£—Ä–æ–≤–µ–Ω—å:</span><span className="tag tag-orange">{userStatus.maxPackage}</span></div>
        <div style={{display:'flex',justifyContent:'space-between'}}><span>–°—Ç–∞—Ç—É—Å:</span><span className="tag tag-blue">{userStatus.rankName}</span></div>
      </div>
      <a href="https://globalway.club" target="_blank" className="btn btn-primary" style={{width:'100%'}}>üöÄ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã</a>
      <button onClick={()=>{setWallet(null);setUserStatus(null)}} className="btn btn-secondary" style={{width:'100%',marginTop:'10px'}}>–û—Ç–∫–ª—é—á–∏—Ç—å</button>
    </div></div>
  );

  return(
    <div style={{display:'flex'}}>
      <aside className="sidebar">
        <div className="sidebar-header"><div style={{display:'flex',alignItems:'center',gap:'10px'}}>
          <span style={{fontSize:'28px'}}>üìä</span>
          <div className="logo-text"><div style={{fontSize:'18px',fontWeight:700,color:'var(--gold)'}}>GlobalCRM</div><div style={{fontSize:'10px',color:'var(--text-muted)'}}>v3.0</div></div>
        </div></div>
        <nav className="sidebar-nav">
          <div className="nav-section">–ì–ª–∞–≤–Ω–æ–µ</div>
          {[{id:'dashboard',icon:'üìà',text:'–î–∞—à–±–æ—Ä–¥'},{id:'learning',icon:'üéì',text:'–û–±—É—á–µ–Ω–∏–µ',badge:LESSONS.length-completedLessons}].map(i=>(
            <div key={i.id} className={`nav-item ${activeSection===i.id?'active':''}`} onClick={()=>setActiveSection(i.id)}>
              <span className="icon">{i.icon}</span><span className="nav-text">{i.text}</span>{i.badge>0&&<span className="badge">{i.badge}</span>}
            </div>
          ))}
          <div className="nav-section">CRM</div>
          {[{id:'contacts',icon:'üë•',text:'–ö–æ–Ω—Ç–∞–∫—Ç—ã',badge:contacts.length},{id:'funnel',icon:'üéØ',text:'–í–æ—Ä–æ–Ω–∫–∞'},{id:'tasks',icon:'‚úÖ',text:'–ó–∞–¥–∞—á–∏',badge:pendingTasks.length}].map(i=>(
            <div key={i.id} className={`nav-item ${activeSection===i.id?'active':''}`} onClick={()=>setActiveSection(i.id)}>
              <span className="icon">{i.icon}</span><span className="nav-text">{i.text}</span>{i.badge>0&&<span className="badge">{i.badge}</span>}
            </div>
          ))}
          <div className="nav-section">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
          <div className={`nav-item ${activeSection==='analytics'?'active':''}`} onClick={()=>setActiveSection('analytics')}><span className="icon">üìä</span><span className="nav-text">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span></div>
          <div className="nav-section">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</div>
          {[{id:'cardgift',icon:'üíå',text:'CardGift'},{id:'globalway',icon:'üåê',text:'GlobalWay'}].map(i=>(
            <div key={i.id} className={`nav-item ${activeSection===i.id?'active':''}`} onClick={()=>setActiveSection(i.id)}>
              <span className="icon">{i.icon}</span><span className="nav-text">{i.text}</span>
            </div>
          ))}
          <div className="nav-section">–°–ø—Ä–∞–≤–∫–∞</div>
          <div className={`nav-item ${activeSection==='help'?'active':''}`} onClick={()=>setActiveSection('help')}><span className="icon">üìñ</span><span className="nav-text">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</span></div>
        </nav>
        <div style={{padding:'15px',borderTop:'1px solid var(--border)'}}>
          <div style={{display:'flex',alignItems:'center',gap:'10px',marginBottom:'10px'}}>
            <div style={{width:'40px',height:'40px',borderRadius:'50%',background:'linear-gradient(135deg,var(--gold),var(--gold-dark))',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:700,color:'#000'}}>{dbUser?.current_level||1}</div>
            <div className="logo-text"><div style={{fontSize:'12px',fontWeight:600}}>{userStatus.rankName}</div><div style={{fontSize:'10px',color:'var(--gold)'}}>‚≠ê {totalPoints} –æ—á–∫–æ–≤</div></div>
          </div>
          <div className="progress-bar" style={{marginBottom:'5px'}}><div className="progress-fill" style={{width:`${(completedLessons/LESSONS.length)*100}%`}}/></div>
          <div className="logo-text" style={{fontSize:'10px',color:'var(--text-muted)',marginBottom:'10px'}}>{completedLessons}/{LESSONS.length} —É—Ä–æ–∫–æ–≤</div>
          <button onClick={()=>{setWallet(null);setUserStatus(null);setDbUser(null);setContacts([]);setTasks([])}} className="btn btn-secondary btn-sm" style={{width:'100%'}}>üö™ –í—ã–π—Ç–∏</button>
        </div>
      </aside>
      <main className="main-content">
        <header className="header">
          <h1 style={{fontSize:'20px'}}>
            {activeSection==='dashboard'&&'üìà –î–∞—à–±–æ—Ä–¥'}{activeSection==='learning'&&'üéì –û–±—É—á–µ–Ω–∏–µ'}{activeSection==='contacts'&&'üë• –ö–æ–Ω—Ç–∞–∫—Ç—ã'}
            {activeSection==='funnel'&&'üéØ –í–æ—Ä–æ–Ω–∫–∞'}{activeSection==='tasks'&&'‚úÖ –ó–∞–¥–∞—á–∏'}{activeSection==='analytics'&&'üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞'}
            {activeSection==='cardgift'&&'üíå CardGift'}{activeSection==='globalway'&&'üåê GlobalWay'}{activeSection==='help'&&'üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è'}
          </h1>
          <div style={{display:'flex',gap:'10px'}}>
            {(activeSection==='contacts'||activeSection==='funnel')&&<button className="btn btn-primary" onClick={()=>{setEditingContact(null);setShowContactModal(true)}}>‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>}
            {activeSection==='tasks'&&<button className="btn btn-primary" onClick={()=>setShowTaskModal(true)}>‚ûï –ó–∞–¥–∞—á–∞</button>}
          </div>
        </header>
        <div className="content fade-in">
          {loadingData?<div style={{textAlign:'center',padding:'60px'}}><div className="loading-spinner" style={{margin:'0 auto 20px'}}/><div>–ó–∞–≥—Ä—É–∑–∫–∞...</div></div>:(
            <>
              {activeSection==='dashboard'&&<Dashboard contacts={contacts} tasks={tasks} pendingTasks={pendingTasks} todayTasks={todayTasks} contactsByStage={contactsByStage} completedLessons={completedLessons} totalPoints={totalPoints} setActiveSection={setActiveSection} setShowContactModal={setShowContactModal} setShowTaskModal={setShowTaskModal}/>}
              {activeSection==='learning'&&<Learning lessons={LESSONS} progress={lessonProgress} totalPoints={totalPoints} onOpen={setShowLessonModal}/>}
              {activeSection==='contacts'&&<Contacts contacts={filteredContacts} search={searchQuery} setSearch={setSearchQuery} filter={stageFilter} setFilter={setStageFilter} onEdit={c=>{setEditingContact(c);setShowContactModal(true)}} onDelete={deleteContact} onStage={moveStage}/>}
              {activeSection==='funnel'&&<Funnel stages={STAGES} byStage={contactsByStage} onEdit={c=>{setEditingContact(c);setShowContactModal(true)}}/>}
              {activeSection==='tasks'&&<Tasks tasks={tasks} onToggle={toggleTask} onDelete={deleteTask}/>}
              {activeSection==='analytics'&&<Analytics contacts={contacts} tasks={tasks} byStage={contactsByStage} stages={STAGES}/>}
              {activeSection==='cardgift'&&<CardGift connected={cardgiftConnected} onConnect={connectCardGift}/>}
              {activeSection==='globalway'&&<GWStatus userStatus={userStatus} wallet={wallet}/>}
              {activeSection==='help'&&<HelpSection/>}
            </>
          )}
        </div>
      </main>
      {showContactModal&&<ContactModal contact={editingContact} stages={STAGES} onSave={editingContact?d=>updateContact(editingContact.id,d):addContact} onClose={()=>{setShowContactModal(false);setEditingContact(null)}}/>}
      {showTaskModal&&<TaskModal contacts={contacts} onSave={addTask} onClose={()=>setShowTaskModal(false)}/>}
      {showLessonModal&&<LessonModal lesson={LESSONS.find(l=>l.id===showLessonModal)} progress={lessonProgress.find(p=>p.lesson_id===showLessonModal)} onToggle={toggleLessonTask} onComplete={completeLesson} onClose={()=>setShowLessonModal(null)}/>}
    </div>
  );
};

// Dashboard
const Dashboard=({contacts,tasks,pendingTasks,todayTasks,contactsByStage,completedLessons,totalPoints,setActiveSection,setShowContactModal,setShowTaskModal})=>(
  <>
    {completedLessons===0&&<div className="card pulse" style={{marginBottom:'20px',background:'linear-gradient(135deg,rgba(255,215,0,.1),rgba(255,165,0,.05))',borderColor:'var(--gold)'}}>
      <div style={{display:'flex',alignItems:'center',gap:'20px',flexWrap:'wrap'}}>
        <div style={{fontSize:'50px'}}>üéâ</div>
        <div style={{flex:1,minWidth:'200px'}}><h2 style={{color:'var(--gold)',marginBottom:'8px'}}>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2><p style={{color:'var(--text-muted)',marginBottom:'15px'}}>–ü—Ä–æ–π–¥–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ</p><button className="btn btn-primary" onClick={()=>setActiveSection('learning')}>üéì –ù–∞—á–∞—Ç—å</button></div>
      </div>
    </div>}
    <div className="stats-grid">
      <div className="stat-card"><div className="icon" style={{background:'rgba(0,212,255,.2)'}}>üë•</div><div className="value">{contacts.length}</div><div className="label">–ö–æ–Ω—Ç–∞–∫—Ç–æ–≤</div></div>
      <div className="stat-card"><div className="icon" style={{background:'rgba(76,175,80,.2)'}}>üöÄ</div><div className="value">{contactsByStage.active?.length||0}</div><div className="label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div></div>
      <div className="stat-card"><div className="icon" style={{background:'rgba(255,152,0,.2)'}}>‚úÖ</div><div className="value">{pendingTasks.length}</div><div className="label">–ó–∞–¥–∞—á</div></div>
      <div className="stat-card"><div className="icon" style={{background:'rgba(255,215,0,.2)'}}>‚≠ê</div><div className="value">{totalPoints}</div><div className="label">–û—á–∫–æ–≤</div></div>
    </div>
    <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'20px'}}>
      <div className="card"><h3 style={{marginBottom:'15px'}}>üöÄ –î–µ–π—Å—Ç–≤–∏—è</h3><div style={{display:'flex',flexDirection:'column',gap:'10px'}}>
        <button className="btn btn-primary" onClick={()=>setShowContactModal(true)}>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç</button>
        <button className="btn btn-secondary" onClick={()=>setShowTaskModal(true)}>üìã –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
        <button className="btn btn-secondary" onClick={()=>setActiveSection('funnel')}>üéØ –í–æ—Ä–æ–Ω–∫–∞</button>
      </div></div>
      <div className="card"><h3 style={{marginBottom:'15px'}}>üìã –°–µ–≥–æ–¥–Ω—è</h3>
        {todayTasks.length===0?<div style={{textAlign:'center',padding:'20px',color:'var(--text-muted)'}}><div style={{fontSize:'30px',marginBottom:'10px'}}>üéâ</div>–ù–µ—Ç –∑–∞–¥–∞—á</div>:
        todayTasks.slice(0,3).map(t=><div key={t.id} style={{display:'flex',alignItems:'center',gap:'10px',padding:'10px 0',borderBottom:'1px solid var(--border)'}}><span className={`tag tag-${t.priority==='high'?'red':'orange'}`} style={{width:'8px',height:'8px',padding:0,borderRadius:'50%'}}/><span style={{flex:1,fontSize:'13px'}}>{t.title}</span></div>)}
      </div>
    </div>
  </>
);

// Learning
const Learning=({lessons,progress,totalPoints,onOpen})=>{
  const getStatus=id=>{const p=progress.find(x=>x.lesson_id===id);return p?.status||'locked'};
  const getTasks=id=>{const p=progress.find(x=>x.lesson_id===id);return p?.tasks_completed?.filter(t=>t.done).length||0};
  const comp=progress.filter(p=>p.status==='completed').length;
  return(<>
    <div className="card" style={{marginBottom:'25px'}}><div style={{display:'flex',alignItems:'center',gap:'20px',flexWrap:'wrap'}}>
      <div style={{flex:1}}><h3 style={{marginBottom:'10px'}}>–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h3><div className="progress-bar" style={{height:'12px',marginBottom:'10px'}}><div className="progress-fill" style={{width:`${(comp/lessons.length)*100}%`}}/></div><div style={{fontSize:'13px',color:'var(--text-muted)'}}>–ü—Ä–æ–π–¥–µ–Ω–æ {comp} –∏–∑ {lessons.length}</div></div>
      <div style={{textAlign:'center',padding:'15px 30px',background:'var(--bg-lighter)',borderRadius:'12px'}}><div style={{fontSize:'28px',fontWeight:700,color:'var(--gold)'}}>‚≠ê {totalPoints}</div><div style={{fontSize:'12px',color:'var(--text-muted)'}}>–æ—á–∫–æ–≤</div></div>
    </div></div>
    <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(300px,1fr))',gap:'20px'}}>
      {lessons.map((l,i)=>{const st=getStatus(l.id);const tc=getTasks(l.id);return(
        <div key={l.id} className={`lesson-card ${st}`} onClick={()=>st!=='locked'&&onOpen(l.id)}>
          <div style={{padding:'20px'}}><div style={{display:'flex',gap:'15px',alignItems:'flex-start'}}>
            <div style={{width:'50px',height:'50px',borderRadius:'12px',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'20px',fontWeight:700,flexShrink:0,background:st==='completed'?'rgba(76,175,80,.2)':st==='active'?'rgba(255,215,0,.2)':'var(--bg-lighter)',color:st==='completed'?'var(--green)':st==='active'?'var(--gold)':'var(--text-muted)'}}>{st==='completed'?'‚úì':st==='locked'?'üîí':i+1}</div>
            <div style={{flex:1}}><h3 style={{fontSize:'15px',marginBottom:'6px'}}>{l.title}</h3><p style={{fontSize:'12px',color:'var(--text-muted)',marginBottom:'10px',lineHeight:1.4}}>{l.desc}</p><div style={{display:'flex',gap:'15px',fontSize:'11px',color:'var(--text-muted)'}}><span>‚è±Ô∏è {l.duration}</span><span style={{color:'var(--gold)'}}>üéÅ +{l.reward}</span></div></div>
          </div>
          {st==='active'&&<div style={{marginTop:'15px'}}><div className="progress-bar" style={{height:'6px'}}><div className="progress-fill" style={{width:`${(tc/l.tasks.length)*100}%`}}/></div><div style={{fontSize:'10px',color:'var(--text-muted)',marginTop:'5px'}}>{tc}/{l.tasks.length}</div></div>}
          </div>
        </div>
      )})}
    </div>
  </>);
};

// Contacts
const Contacts=({contacts,search,setSearch,filter,setFilter,onEdit,onDelete,onStage})=>(<>
  <div style={{display:'flex',gap:'15px',marginBottom:'20px',flexWrap:'wrap'}}>
    <input className="input" placeholder="üîç –ü–æ–∏—Å–∫..." value={search} onChange={e=>setSearch(e.target.value)} style={{maxWidth:'250px'}}/>
    <select className="input" value={filter} onChange={e=>setFilter(e.target.value)} style={{width:'auto'}}><option value="all">–í—Å–µ —ç—Ç–∞–ø—ã</option>{STAGES.map(s=><option key={s.id} value={s.id}>{s.icon} {s.name}</option>)}</select>
  </div>
  <div className="card" style={{overflow:'auto'}}><table className="table"><thead><tr><th>–ö–æ–Ω—Ç–∞–∫—Ç</th><th>–¢–µ–ª–µ—Ñ–æ–Ω</th><th>–≠—Ç–∞–ø</th><th>–ò—Å—Ç–æ—á–Ω–∏–∫</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody>
    {contacts.map(c=><tr key={c.id}><td><div style={{fontWeight:500}}>{c.name}</div><div style={{fontSize:'12px',color:'var(--text-muted)'}}>{c.email}</div></td><td style={{fontSize:'13px'}}>{c.phone||'‚Äî'}</td>
    <td><select className="input" value={c.stage} onChange={e=>onStage(c.id,e.target.value)} style={{padding:'6px',fontSize:'12px',width:'auto'}}>{STAGES.map(s=><option key={s.id} value={s.id}>{s.icon} {s.name}</option>)}</select></td>
    <td><span className="tag tag-blue">{c.source}</span></td>
    <td><div style={{display:'flex',gap:'5px'}}><button className="btn btn-sm btn-secondary" onClick={()=>onEdit(c)}>‚úèÔ∏è</button><button className="btn btn-sm btn-danger" onClick={()=>onDelete(c.id)}>üóëÔ∏è</button></div></td></tr>)}
  </tbody></table>{contacts.length===0&&<div style={{textAlign:'center',padding:'40px',color:'var(--text-muted)'}}>–ù–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤</div>}</div>
</>);

// Funnel
const Funnel=({stages,byStage,onEdit})=>(<div style={{display:'grid',gridTemplateColumns:`repeat(${stages.length},1fr)`,gap:'15px',overflowX:'auto',minWidth:'800px'}}>
  {stages.map(s=><div key={s.id} className="funnel-stage">
    <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'15px',paddingBottom:'10px',borderBottom:'1px solid var(--border)'}}><span style={{fontWeight:600}}>{s.icon} {s.name}</span><span className={`tag tag-${s.color}`}>{byStage[s.id]?.length||0}</span></div>
    {byStage[s.id]?.map(c=><div key={c.id} className="funnel-card" onClick={()=>onEdit(c)}><div style={{fontWeight:500,marginBottom:'4px'}}>{c.name}</div><div style={{fontSize:'11px',color:'var(--text-muted)'}}>{c.email}</div></div>)}
    {(!byStage[s.id]||byStage[s.id].length===0)&&<div style={{textAlign:'center',padding:'20px',color:'var(--text-muted)',fontSize:'12px'}}>–ü—É—Å—Ç–æ</div>}
  </div>)}
</div>);

// Tasks
const Tasks=({tasks,onToggle,onDelete})=>{const pend=tasks.filter(t=>t.status!=='completed');const done=tasks.filter(t=>t.status==='completed');return(<>
  <h3 style={{marginBottom:'15px'}}>üìã –ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é ({pend.length})</h3>
  <div className="card" style={{marginBottom:'25px'}}>{pend.length===0?<div style={{textAlign:'center',padding:'30px',color:'var(--text-muted)'}}>üéâ –í—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!</div>:pend.map(t=><div key={t.id} style={{display:'flex',alignItems:'center',gap:'12px',padding:'12px',borderBottom:'1px solid var(--border)'}}>
    <input type="checkbox" onChange={()=>onToggle(t.id,true)} style={{width:'18px',height:'18px',accentColor:'var(--gold)'}}/>
    <div style={{flex:1}}><div style={{fontWeight:500}}>{t.title}</div><div style={{fontSize:'11px',color:'var(--text-muted)'}}>üìÖ {t.due_date}</div></div>
    <span className={`tag tag-${t.priority==='high'?'red':t.priority==='medium'?'orange':'blue'}`}>{t.priority}</span>
    <button className="btn btn-sm btn-danger" onClick={()=>onDelete(t.id)}>üóëÔ∏è</button>
  </div>)}</div>
  {done.length>0&&<><h3 style={{marginBottom:'15px',color:'var(--text-muted)'}}>‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ ({done.length})</h3><div className="card" style={{opacity:.7}}>{done.slice(0,5).map(t=><div key={t.id} style={{display:'flex',alignItems:'center',gap:'12px',padding:'10px',borderBottom:'1px solid var(--border)'}}><input type="checkbox" checked onChange={()=>onToggle(t.id,false)} style={{width:'16px',height:'16px',accentColor:'var(--green)'}}/><span style={{textDecoration:'line-through',color:'var(--text-muted)'}}>{t.title}</span></div>)}</div></>}
</>)};

// Analytics
const Analytics=({contacts,tasks,byStage,stages})=>{
  const chartRef=useRef(null);const chartInst=useRef(null);
  useEffect(()=>{
    if(chartRef.current){
      if(chartInst.current)chartInst.current.destroy();
      chartInst.current=new Chart(chartRef.current,{type:'doughnut',data:{labels:stages.map(s=>s.name),datasets:[{data:stages.map(s=>byStage[s.id]?.length||0),backgroundColor:['#00d4ff','#ff9800','#9c27b0','#FFD700','#4CAF50'],borderWidth:0}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{color:'#9CA3AF',padding:15}}}}});
    }
    return()=>{if(chartInst.current)chartInst.current.destroy()};
  },[contacts,byStage]);
  const conv=contacts.length?Math.round((byStage.active?.length||0)/contacts.length*100):0;
  const compTasks=tasks.filter(t=>t.status==='completed').length;
  return(<>
    <div className="stats-grid" style={{marginBottom:'25px'}}>
      <div className="stat-card"><div className="value" style={{color:'var(--accent)'}}>{contacts.length}</div><div className="label">–í—Å–µ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤</div></div>
      <div className="stat-card"><div className="value" style={{color:'var(--green)'}}>{byStage.active?.length||0}</div><div className="label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div></div>
      <div className="stat-card"><div className="value" style={{color:'var(--orange)'}}>{conv}%</div><div className="label">–ö–æ–Ω–≤–µ—Ä—Å–∏—è</div></div>
      <div className="stat-card"><div className="value" style={{color:'var(--purple)'}}>{compTasks}</div><div className="label">–ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div></div>
    </div>
    <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'20px'}}>
      <div className="card"><h3 style={{marginBottom:'20px'}}>üìä –í–æ—Ä–æ–Ω–∫–∞</h3><div className="chart-container"><canvas ref={chartRef}/></div></div>
      <div className="card"><h3 style={{marginBottom:'20px'}}>üìà –ü–æ —ç—Ç–∞–ø–∞–º</h3>
        {stages.map(s=>{const cnt=byStage[s.id]?.length||0;const pct=contacts.length?Math.round(cnt/contacts.length*100):0;return(
          <div key={s.id} style={{marginBottom:'15px'}}><div style={{display:'flex',justifyContent:'space-between',marginBottom:'5px',fontSize:'13px'}}><span>{s.icon} {s.name}</span><span style={{color:'var(--gold)'}}>{cnt} ({pct}%)</span></div><div className="progress-bar"><div className="progress-fill" style={{width:`${pct}%`}}/></div></div>
        )})}
      </div>
    </div>
  </>);
};

// CardGift
const CardGift=({connected,onConnect})=>{
  if(!connected)return(<div className="card" style={{textAlign:'center',padding:'60px'}}><div style={{fontSize:'60px',marginBottom:'20px'}}>üíå</div><h2 style={{marginBottom:'15px',color:'var(--gold)'}}>CardGift</h2><p style={{color:'var(--text-muted)',marginBottom:'25px',maxWidth:'400px',margin:'0 auto 25px'}}>–ê–≤—Ç–æ–∏–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏–∑ –æ—Ç–∫—Ä—ã—Ç–æ–∫</p><button className="btn btn-primary" onClick={onConnect}>üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å</button></div>);
  return(<div className="card"><div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}><div><span className="tag tag-green">‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ</span><span style={{marginLeft:'15px',color:'var(--text-muted)'}}>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞</span></div><button className="btn btn-secondary">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button></div></div>);
};

// GWStatus
const GWStatus=({userStatus,wallet})=>(<div className="card"><h2 style={{marginBottom:'20px',color:'var(--gold)'}}>üåê GlobalWay —Å—Ç–∞—Ç—É—Å</h2>
  <div style={{display:'grid',gap:'12px'}}>
    {[{l:'ODIX ID',v:userStatus.odixId},{l:'–†–∞–Ω–≥',v:userStatus.rankName,tag:'gold'},{l:'–ü–∞–∫–µ—Ç',v:userStatus.maxPackage},{l:'–ö–≤–∞—Ä—Ç–∞–ª',v:userStatus.quarterlyActive?'‚úÖ –ê–∫—Ç–∏–≤–µ–Ω':'‚ùå –ù–µ—Ç',tag:userStatus.quarterlyActive?'green':'red'}].map((i,idx)=>(
      <div key={idx} style={{display:'flex',justifyContent:'space-between',padding:'15px',background:'var(--bg-lighter)',borderRadius:'8px'}}><span style={{color:'var(--text-muted)'}}>{i.l}</span>{i.tag?<span className={`tag tag-${i.tag}`}>{i.v}</span>:<span style={{color:'var(--gold)',fontWeight:600}}>{i.v}</span>}</div>
    ))}
  </div>
  <div style={{marginTop:'20px'}}><h3 style={{marginBottom:'15px'}}>–ü–∞–∫–µ—Ç—ã</h3><div style={{display:'flex',gap:'8px',flexWrap:'wrap'}}>
    {userStatus.activeLevels?.map((a,i)=><div key={i} style={{width:'40px',height:'40px',borderRadius:'8px',display:'flex',alignItems:'center',justifyContent:'center',background:a?'rgba(76,175,80,.2)':'var(--bg-lighter)',border:`1px solid ${a?'var(--green)':'var(--border)'}`,color:a?'var(--green)':'var(--text-muted)',fontWeight:600}}>{i+1}</div>)}
  </div></div>
</div>);

// HELP SECTION - –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
const HelpSection=()=>{
  const[activeTab,setActiveTab]=useState('start');
  const tabs=[
    {id:'start',icon:'üöÄ',name:'–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã'},
    {id:'contacts',icon:'üë•',name:'–ö–æ–Ω—Ç–∞–∫—Ç—ã'},
    {id:'funnel',icon:'üéØ',name:'–í–æ—Ä–æ–Ω–∫–∞'},
    {id:'tasks',icon:'‚úÖ',name:'–ó–∞–¥–∞—á–∏'},
    {id:'learning',icon:'üéì',name:'–û–±—É—á–µ–Ω–∏–µ'},
    {id:'analytics',icon:'üìä',name:'–ê–Ω–∞–ª–∏—Ç–∏–∫–∞'},
    {id:'integrations',icon:'üîó',name:'–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏'},
    {id:'future',icon:'üîÆ',name:'–ü–ª–∞–Ω—ã v4.0'}
  ];
  return(<>
    <div className="card" style={{marginBottom:'25px',background:'linear-gradient(135deg,rgba(255,215,0,.1),rgba(255,165,0,.05))',borderColor:'var(--gold)'}}>
      <div style={{display:'flex',alignItems:'center',gap:'20px'}}>
        <div style={{fontSize:'50px'}}>üìñ</div>
        <div><h2 style={{color:'var(--gold)',marginBottom:'5px'}}>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è GlobalCRM v3.0</h2><p style={{color:'var(--text-muted)'}}>–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã</p></div>
      </div>
    </div>
    <div className="help-nav">
      {tabs.map(t=><button key={t.id} className={`help-nav-btn ${activeTab===t.id?'active':''}`} onClick={()=>setActiveTab(t.id)}>{t.icon} {t.name}</button>)}
    </div>
    <div className="card">
      {activeTab==='start'&&<HelpStart/>}
      {activeTab==='contacts'&&<HelpContacts/>}
      {activeTab==='funnel'&&<HelpFunnel/>}
      {activeTab==='tasks'&&<HelpTasks/>}
      {activeTab==='learning'&&<HelpLearning/>}
      {activeTab==='analytics'&&<HelpAnalytics/>}
      {activeTab==='integrations'&&<HelpIntegrations/>}
      {activeTab==='future'&&<HelpFuture/>}
    </div>
  </>);
};

const HelpStart=()=>(<div className="help-section">
  <h2>üöÄ –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã</h2>
  <p>GlobalCRM ‚Äî —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º–∏ –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ GlobalWay.</p>
  
  <h3>üìã –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</h3>
  <table className="help-table">
    <thead><tr><th>–§—É–Ω–∫—Ü–∏—è</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th></tr></thead>
    <tbody>
      <tr><td>üë• –ö–æ–Ω—Ç–∞–∫—Ç—ã</td><td>–ë–∞–∑–∞ –≤—Å–µ—Ö –≤–∞—à–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å —Ç–µ–≥–∞–º–∏ –∏ –∑–∞–º–µ—Ç–∫–∞–º–∏</td></tr>
      <tr><td>üéØ –í–æ—Ä–æ–Ω–∫–∞</td><td>5 —ç—Ç–∞–ø–æ–≤: –ù–æ–≤—ã–π ‚Üí –ò–Ω—Ç–µ—Ä–µ—Å ‚Üí –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è ‚Üí –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ê–∫—Ç–∏–≤–Ω—ã–π</td></tr>
      <tr><td>‚úÖ –ó–∞–¥–∞—á–∏</td><td>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–≤–æ–Ω–∫–æ–≤, –≤—Å—Ç—Ä–µ—á, follow-up</td></tr>
      <tr><td>üéì –û–±—É—á–µ–Ω–∏–µ</td><td>8 —É—Ä–æ–∫–æ–≤ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ (–¥–æ 270 –æ—á–∫–æ–≤)</td></tr>
      <tr><td>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</td><td>–ì—Ä–∞—Ñ–∏–∫–∏, –∫–æ–Ω–≤–µ—Ä—Å–∏—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</td></tr>
      <tr><td>üíå CardGift</td><td>–ê–≤—Ç–æ–∏–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏–∑ –æ—Ç–∫—Ä—ã—Ç–æ–∫</td></tr>
    </tbody>
  </table>

  <h3>‚ö° –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞</h3>
  <ul>
    <li>‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ GlobalWay</li>
    <li>‚úÖ –ú–∏–Ω–∏–º—É–º 4-–π –ø–∞–∫–µ—Ç (MiniAdmin)</li>
    <li>‚úÖ –°–µ—Ç—å opBNB</li>
    <li>‚úÖ –ö–æ—à–µ–ª—ë–∫ MetaMask –∏–ª–∏ SafePal</li>
  </ul>

  <h3>üîó –®–∞–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h3>
  <div className="help-card"><div className="help-card-title">1Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ CRM</div><p>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É CRM –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤ –¥–∞—à–±–æ—Ä–¥–µ CardGift</p></div>
  <div className="help-card"><div className="help-card-title">2Ô∏è‚É£ –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª—ë–∫</div><p>–ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫" –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤ MetaMask/SafePal</p></div>
  <div className="help-card"><div className="help-card-title">3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞</div><p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç –≤–∞—à —Å—Ç–∞—Ç—É—Å –≤ GlobalWay</p></div>
  <div className="help-card"><div className="help-card-title">4Ô∏è‚É£ –ù–∞—á–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É</div><p>–ü—Ä–æ–π–¥–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã</p></div>
</div>);

const HelpContacts=()=>(<div className="help-section">
  <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏</h2>
  
  <h3>‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞</h3>
  <p>–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å" –≤ —Ä–∞–∑–¥–µ–ª–µ –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏–ª–∏ –í–æ—Ä–æ–Ω–∫–∞ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:</p>
  <table className="help-table">
    <thead><tr><th>–ü–æ–ª–µ</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th></tr></thead>
    <tbody>
      <tr><td><strong>–ò–º—è *</strong></td><td>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</td></tr>
      <tr><td>Email</td><td>–î–ª—è email-—Ä–∞—Å—Å—ã–ª–æ–∫</td></tr>
      <tr><td>–¢–µ–ª–µ—Ñ–æ–Ω</td><td>–î–ª—è –∑–≤–æ–Ω–∫–æ–≤</td></tr>
      <tr><td>Telegram</td><td>Username –±–µ–∑ @</td></tr>
      <tr><td>–≠—Ç–∞–ø</td><td>–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø –≤–æ—Ä–æ–Ω–∫–∏</td></tr>
      <tr><td>–ò—Å—Ç–æ—á–Ω–∏–∫</td><td>–û—Ç–∫—É–¥–∞ –ø—Ä–∏—à—ë–ª –∫–æ–Ω—Ç–∞–∫—Ç</td></tr>
      <tr><td>–ó–∞–º–µ—Ç–∫–∏</td><td>–õ—é–±–∞—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</td></tr>
    </tbody>
  </table>

  <h3>üìã –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤</h3>
  <ul>
    <li><strong>–í—Ä—É—á–Ω—É—é</strong> ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –≤–∞–º–∏</li>
    <li><strong>CardGift</strong> ‚Äî –∏–∑ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –æ—Ç–∫—Ä—ã—Ç–æ–∫</li>
    <li><strong>Telegram</strong> ‚Äî –∏–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞</li>
    <li><strong>–°–∞–π—Ç</strong> ‚Äî –∑–∞—è–≤–∫–∞ —Å —Å–∞–π—Ç–∞</li>
    <li><strong>–†–µ—Ñ–µ—Ä–∞–ª</strong> ‚Äî –ø–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</li>
  </ul>

  <h3>üîß –î–µ–π—Å—Ç–≤–∏—è —Å –∫–æ–Ω—Ç–∞–∫—Ç–æ–º</h3>
  <ul>
    <li>‚úèÔ∏è <strong>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</strong> ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</li>
    <li>üóëÔ∏è <strong>–£–¥–∞–ª–∏—Ç—å</strong> ‚Äî —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç</li>
    <li>üìã <strong>–°–º–µ–Ω–∏—Ç—å —ç—Ç–∞–ø</strong> ‚Äî –≤—ã–±—Ä–∞—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞</li>
  </ul>

  <h3>üîç –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã</h3>
  <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ email. –§–∏–ª—å—Ç—Ä –ø–æ —ç—Ç–∞–ø–∞–º –ø–æ–∫–∞–∂–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–∞–∫—Ç—ã –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –≤–æ—Ä–æ–Ω–∫–∏.</p>
</div>);

const HelpFunnel=()=>(<div className="help-section">
  <h2>üéØ –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂</h2>
  <p>–í–æ—Ä–æ–Ω–∫–∞ ‚Äî –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –¥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞.</p>
  
  <h3>üìä 5 —ç—Ç–∞–ø–æ–≤ –≤–æ—Ä–æ–Ω–∫–∏</h3>
  <table className="help-table">
    <thead><tr><th>–≠—Ç–∞–ø</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
    <tbody>
      <tr><td>üÜï <strong>–ù–æ–≤—ã–π</strong></td><td>–¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç</td><td>–ü–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç, –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ</td></tr>
      <tr><td>üëÄ <strong>–ò–Ω—Ç–µ—Ä–µ—Å</strong></td><td>–ü—Ä–æ—è–≤–∏–ª –∏–Ω—Ç–µ—Ä–µ—Å</td><td>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã</td></tr>
      <tr><td>üìä <strong>–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è</strong></td><td>–ù–∞–∑–Ω–∞—á–µ–Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è</td><td>–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é, –æ–±—ä—è—Å–Ω–∏—Ç—å –¥–µ—Ç–∞–ª–∏</td></tr>
      <tr><td>üìù <strong>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</strong></td><td>–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</td><td>–ü–æ–º–æ—á—å —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π</td></tr>
      <tr><td>üöÄ <strong>–ê–∫—Ç–∏–≤–Ω—ã–π</strong></td><td>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω</td><td>–ü–æ–¥–¥–µ—Ä–∂–∫–∞, –æ–±—É—á–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω—ë—Ä–∞</td></tr>
    </tbody>
  </table>

  <h3>üîÑ –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤</h3>
  <p>–í —Ä–∞–∑–¥–µ–ª–µ –í–æ—Ä–æ–Ω–∫–∞ –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –∫–æ–Ω—Ç–∞–∫—Ç–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –í —Ä–∞–∑–¥–µ–ª–µ –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≤ –∫–æ–ª–æ–Ω–∫–µ "–≠—Ç–∞–ø".</p>

  <div className="help-card">
    <div className="help-card-title">üí° –°–æ–≤–µ—Ç</div>
    <p>–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —ç—Ç–∞–ø—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ ‚Äî —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è.</p>
  </div>
</div>);

const HelpTasks=()=>(<div className="help-section">
  <h2>‚úÖ –ó–∞–¥–∞—á–∏ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h2>
  
  <h3>‚ûï –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</h3>
  <p>–ù–∞–∂–º–∏—Ç–µ "–ó–∞–¥–∞—á–∞" –≤ —Ä–∞–∑–¥–µ–ª–µ –ó–∞–¥–∞—á–∏ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:</p>
  <ul>
    <li><strong>–ù–∞–∑–≤–∞–Ω–∏–µ</strong> ‚Äî —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å</li>
    <li><strong>–ö–æ–Ω—Ç–∞–∫—Ç</strong> ‚Äî –∫ –∫–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</li>
    <li><strong>–°—Ä–æ–∫</strong> ‚Äî –¥–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</li>
    <li><strong>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</strong> ‚Äî –≤–∞–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏</li>
  </ul>

  <h3>üé® –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</h3>
  <table className="help-table">
    <thead><tr><th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th><th>–¶–≤–µ—Ç</th><th>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</th></tr></thead>
    <tbody>
      <tr><td>üîµ –ù–∏–∑–∫–∏–π</td><td>–°–∏–Ω–∏–π</td><td>–ú–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å</td></tr>
      <tr><td>üü° –°—Ä–µ–¥–Ω–∏–π</td><td>–û—Ä–∞–Ω–∂–µ–≤—ã–π</td><td>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏</td></tr>
      <tr><td>üî¥ –í—ã—Å–æ–∫–∏–π</td><td>–ö—Ä–∞—Å–Ω—ã–π</td><td>–°—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏</td></tr>
    </tbody>
  </table>

  <h3>‚úì –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ</h3>
  <ul>
    <li>–û—Ç–º–µ—Ç—å—Ç–µ —á–µ–∫–±–æ–∫—Å ‚Äî –∑–∞–¥–∞—á–∞ –ø–µ—Ä–µ–π–¥—ë—Ç –≤ "–í—ã–ø–æ–ª–Ω–µ–Ω–æ"</li>
    <li>–°–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É ‚Äî –≤–µ—Ä–Ω—ë—Ç—Å—è –≤ "–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é"</li>
    <li>–ù–∞ –î–∞—à–±–æ—Ä–¥–µ –≤–∏–¥–Ω—ã –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</li>
  </ul>
</div>);

const HelpLearning=()=>(<div className="help-section">
  <h2>üéì –°–∏—Å—Ç–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è</h2>
  
  <h3>üìö 8 —É—Ä–æ–∫–æ–≤</h3>
  <table className="help-table">
    <thead><tr><th>#</th><th>–£—Ä–æ–∫</th><th>–í—Ä–µ–º—è</th><th>–û—á–∫–∏</th></tr></thead>
    <tbody>
      <tr><td>1</td><td>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</td><td>5 –º–∏–Ω</td><td>10</td></tr>
      <tr><td>2</td><td>–†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏</td><td>10 –º–∏–Ω</td><td>20</td></tr>
      <tr><td>3</td><td>–í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂</td><td>15 –º–∏–Ω</td><td>30</td></tr>
      <tr><td>4</td><td>–ó–∞–¥–∞—á–∏ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</td><td>10 –º–∏–Ω</td><td>25</td></tr>
      <tr><td>5</td><td>CardGift –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</td><td>12 –º–∏–Ω</td><td>35</td></tr>
      <tr><td>6</td><td>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤</td><td>12 –º–∏–Ω</td><td>40</td></tr>
      <tr><td>7</td><td>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</td><td>15 –º–∏–Ω</td><td>50</td></tr>
      <tr><td>8</td><td>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</td><td>20 –º–∏–Ω</td><td>60</td></tr>
    </tbody>
  </table>
  <p style={{marginTop:'10px',color:'var(--gold)',fontWeight:600}}>–í—Å–µ–≥–æ: 270 –æ—á–∫–æ–≤</p>

  <h3>üìñ –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —É—Ä–æ–∫–∞</h3>
  <ol>
    <li>–û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–û–±—É—á–µ–Ω–∏–µ"</li>
    <li>–í—ã–±–µ—Ä–∏—Ç–µ –∞–∫—Ç–∏–≤–Ω—ã–π —É—Ä–æ–∫ (—Å –∑–æ–ª–æ—Ç–æ–π —Ä–∞–º–∫–æ–π)</li>
    <li>–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∏–¥–µ–æ</li>
    <li>–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è (–∫–ª–∏–∫–∞–π—Ç–µ –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏)</li>
    <li>–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫"</li>
  </ol>

  <h3>üìä –°—Ç–∞—Ç—É—Å—ã —É—Ä–æ–∫–æ–≤</h3>
  <ul>
    <li>üîí <strong>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</strong> ‚Äî –ø—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π</li>
    <li>üü° <strong>–ê–∫—Ç–∏–≤–Ω—ã–π</strong> ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å</li>
    <li>‚úÖ <strong>–ó–∞–≤–µ—Ä—à—ë–Ω</strong> ‚Äî —É—Ä–æ–∫ –ø—Ä–æ–π–¥–µ–Ω</li>
  </ul>
</div>);

const HelpAnalytics=()=>(<div className="help-section">
  <h2>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
  
  <h3>üìà –ú–µ—Ç—Ä–∏–∫–∏</h3>
  <table className="help-table">
    <thead><tr><th>–ú–µ—Ç—Ä–∏–∫–∞</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th></tr></thead>
    <tbody>
      <tr><td>–í—Å–µ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤</td><td>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –±–∞–∑–µ</td></tr>
      <tr><td>–ê–∫—Ç–∏–≤–Ω—ã—Ö</td><td>–ö–æ–Ω—Ç–∞–∫—Ç—ã –Ω–∞ —ç—Ç–∞–ø–µ "–ê–∫—Ç–∏–≤–Ω—ã–π"</td></tr>
      <tr><td>–ö–æ–Ω–≤–µ—Ä—Å–∏—è</td><td>% –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞</td></tr>
      <tr><td>–ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</td><td>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á</td></tr>
    </tbody>
  </table>

  <h3>üìä –ì—Ä–∞—Ñ–∏–∫ –≤–æ—Ä–æ–Ω–∫–∏</h3>
  <p>–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø–æ —ç—Ç–∞–ø–∞–º ‚Äî –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å –ª–µ–≥–µ–Ω–¥–æ–π.</p>

  <h3>üìà –ü–æ —ç—Ç–∞–ø–∞–º</h3>
  <p>–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞.</p>
</div>);

const HelpIntegrations=()=>(<div className="help-section">
  <h2>üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</h2>
  
  <h3>üíå CardGift</h3>
  <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏–∑ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –æ—Ç–∫—Ä—ã—Ç–æ–∫.</p>
  <div className="help-card">
    <div className="help-card-title">–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç</div>
    <ol>
      <li>–í—ã —Å–æ–∑–¥–∞—ë—Ç–µ –æ—Ç–∫—Ä—ã—Ç–∫—É –≤ CardGift</li>
      <li>–ü–æ–ª—É—á–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç</li>
      <li>–ö–æ–Ω—Ç–∞–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ CRM</li>
    </ol>
  </div>
  <p><strong>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:</strong> –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª CardGift ‚Üí –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å"</p>

  <h3>üåê GlobalWay</h3>
  <p>–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–∞—à —Å—Ç–∞—Ç—É—Å –≤ –±–ª–æ–∫—á–µ–π–Ω–µ:</p>
  <ul>
    <li><strong>ODIX ID</strong> ‚Äî –≤–∞—à –Ω–æ–º–µ—Ä –≤ —Å–∏—Å—Ç–µ–º–µ</li>
    <li><strong>–†–∞–Ω–≥</strong> ‚Äî Client, MiniAdmin, Admin...</li>
    <li><strong>–ü–∞–∫–µ—Ç</strong> ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</li>
    <li><strong>–ö–≤–∞—Ä—Ç–∞–ª</strong> ‚Äî —Å—Ç–∞—Ç—É—Å –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞</li>
    <li><strong>–ü–∞–∫–µ—Ç—ã</strong> ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è 12 –ø–∞–∫–µ—Ç–æ–≤</li>
  </ul>
</div>);

const HelpFuture=()=>(<div className="help-section">
  <h2>üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è v4.0</h2>
  
  <div className="help-card" style={{borderColor:'var(--gold)'}}>
    <div className="help-card-title">üìÇ –ú—É–ª—å—Ç–∏-–ø—Ä–æ–µ–∫—Ç—ã</div>
    <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ CRM –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:</p>
    <ul>
      <li>GlobalWay CRM</li>
      <li>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω</li>
      <li>–§—Ä–∏–ª–∞–Ω—Å –∫–ª–∏–µ–Ω—Ç—ã</li>
      <li>–ò –¥—Ä—É–≥–∏–µ...</li>
    </ul>
  </div>

  <div className="help-card" style={{borderColor:'var(--accent)'}}>
    <div className="help-card-title">üìß –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—ã–ª–æ–∫</div>
    <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–º–ø–∞–Ω–∏–π:</p>
    <ul>
      <li>–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–µ—Ä–∏—è</li>
      <li>–†–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è</li>
      <li>–ê–Ω–æ–Ω—Å –≤–µ–±–∏–Ω–∞—Ä–∞</li>
      <li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ü–µ–ø–æ—á–∫–∏</li>
    </ul>
  </div>

  <div className="help-card" style={{borderColor:'var(--purple)'}}>
    <div className="help-card-title">üéØ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≤–æ—Ä–æ–Ω–∫–∏</div>
    <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–∏ –≤–æ—Ä–æ–Ω–∫–∏ —Å –ª—é–±—ã–º–∏ —ç—Ç–∞–ø–∞–º–∏:</p>
    <ul>
      <li>–õ–∏–¥ ‚Üí –°–æ–∑–≤–æ–Ω ‚Üí –û–ø–ª–∞—Ç–∞ ‚Üí –û–±—É—á–µ–Ω–∏–µ ‚Üí –û—Ç–∑—ã–≤</li>
      <li>–õ—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Ç–∞–ø–æ–≤</li>
      <li>–°–≤–æ–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –∏–∫–æ–Ω–∫–∏</li>
    </ul>
  </div>

  <div className="help-card" style={{borderColor:'var(--green)'}}>
    <div className="help-card-title">üîí –†–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ</div>
    <p>–ê–Ω–æ–Ω–∏–º–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –±–µ–∑ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:</p>
    <ul>
      <li>–¢–æ–ª—å–∫–æ ID –∏–ª–∏ –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞</li>
      <li>–ë–µ–∑ email –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞</li>
      <li>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å</li>
    </ul>
  </div>

  <div style={{marginTop:'20px',padding:'15px',background:'var(--bg-lighter)',borderRadius:'10px',textAlign:'center'}}>
    <p style={{color:'var(--text-muted)',marginBottom:'10px'}}>–ï—Å—Ç—å –∏–¥–µ–∏? –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º!</p>
    <p style={{color:'var(--gold)'}}>Telegram: @globalway_support</p>
  </div>
</div>);

// ContactModal
const ContactModal=({contact,stages,onSave,onClose})=>{
  const[form,setForm]=useState(contact||{name:'',email:'',phone:'',telegram:'',stage:'new',source:'manual',notes:''});
  return(<div className="modal-overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()}><div className="modal-header"><h2>{contact?'‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å':'‚ûï –ù–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç'}</h2><button onClick={onClose} style={{background:'none',border:'none',color:'var(--text-muted)',fontSize:'20px',cursor:'pointer'}}>‚úï</button></div>
    <form onSubmit={e=>{e.preventDefault();if(form.name.trim())onSave(form)}}><div className="modal-body">
      {[{k:'name',l:'–ò–º—è *',t:'text'},{k:'email',l:'Email',t:'email'},{k:'phone',l:'–¢–µ–ª–µ—Ñ–æ–Ω',t:'text'},{k:'telegram',l:'Telegram',t:'text'}].map(f=><div key={f.k} style={{marginBottom:'15px'}}><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>{f.l}</label><input className="input" type={f.t} value={form[f.k]} onChange={e=>setForm({...form,[f.k]:e.target.value})}/></div>)}
      <div style={{marginBottom:'15px'}}><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>–≠—Ç–∞–ø</label><select className="input" value={form.stage} onChange={e=>setForm({...form,stage:e.target.value})}>{stages.map(s=><option key={s.id} value={s.id}>{s.icon} {s.name}</option>)}</select></div>
      <div style={{marginBottom:'15px'}}><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>–ò—Å—Ç–æ—á–Ω–∏–∫</label><select className="input" value={form.source} onChange={e=>setForm({...form,source:e.target.value})}><option value="manual">–í—Ä—É—á–Ω—É—é</option><option value="cardgift">CardGift</option><option value="telegram">Telegram</option><option value="website">–°–∞–π—Ç</option><option value="referral">–†–µ—Ñ–µ—Ä–∞–ª</option></select></div>
      <div><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>–ó–∞–º–µ—Ç–∫–∏</label><textarea className="input" value={form.notes} onChange={e=>setForm({...form,notes:e.target.value})} rows="3"/></div>
    </div><div className="modal-footer"><button type="button" className="btn btn-secondary" onClick={onClose}>–û—Ç–º–µ–Ω–∞</button><button type="submit" className="btn btn-primary">{contact?'–°–æ—Ö—Ä–∞–Ω–∏—Ç—å':'–î–æ–±–∞–≤–∏—Ç—å'}</button></div></form>
  </div></div>);
};

// TaskModal
const TaskModal=({contacts,onSave,onClose})=>{
  const[form,setForm]=useState({title:'',contact_id:null,due_date:new Date().toISOString().split('T')[0],priority:'medium'});
  return(<div className="modal-overlay" onClick={onClose}><div className="modal" onClick={e=>e.stopPropagation()}><div className="modal-header"><h2>‚ûï –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h2><button onClick={onClose} style={{background:'none',border:'none',color:'var(--text-muted)',fontSize:'20px',cursor:'pointer'}}>‚úï</button></div>
    <form onSubmit={e=>{e.preventDefault();if(form.title.trim())onSave(form)}}><div className="modal-body">
      <div style={{marginBottom:'15px'}}><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>–ù–∞–∑–≤–∞–Ω–∏–µ *</label><input className="input" value={form.title} onChange={e=>setForm({...form,title:e.target.value})} placeholder="–ü–æ–∑–≤–æ–Ω–∏—Ç—å..."/></div>
      <div style={{marginBottom:'15px'}}><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>–ö–æ–Ω—Ç–∞–∫—Ç</label><select className="input" value={form.contact_id||''} onChange={e=>setForm({...form,contact_id:e.target.value||null})}><option value="">‚Äî –ë–µ–∑ –∫–æ–Ω—Ç–∞–∫—Ç–∞ ‚Äî</option>{contacts.map(c=><option key={c.id} value={c.id}>{c.name}</option>)}</select></div>
      <div style={{marginBottom:'15px'}}><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>–°—Ä–æ–∫</label><input className="input" type="date" value={form.due_date} onChange={e=>setForm({...form,due_date:e.target.value})}/></div>
      <div><label style={{display:'block',marginBottom:'5px',fontSize:'13px',color:'var(--text-muted)'}}>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label><select className="input" value={form.priority} onChange={e=>setForm({...form,priority:e.target.value})}><option value="low">üîµ –ù–∏–∑–∫–∏–π</option><option value="medium">üü° –°—Ä–µ–¥–Ω–∏–π</option><option value="high">üî¥ –í—ã—Å–æ–∫–∏–π</option></select></div>
    </div><div className="modal-footer"><button type="button" className="btn btn-secondary" onClick={onClose}>–û—Ç–º–µ–Ω–∞</button><button type="submit" className="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button></div></form>
  </div></div>);
};

// LessonModal
const LessonModal=({lesson,progress,onToggle,onComplete,onClose})=>{
  if(!lesson||!progress)return null;
  const allDone=progress.tasks_completed?.every(t=>t.done);
  return(<div className="modal-overlay" onClick={onClose}><div className="modal" style={{maxWidth:'650px'}} onClick={e=>e.stopPropagation()}>
    <div className="modal-header"><div><h2 style={{fontSize:'18px',marginBottom:'5px'}}>üéì –£—Ä–æ–∫ {lesson.id}: {lesson.title}</h2><div style={{fontSize:'13px',color:'var(--text-muted)'}}>‚è±Ô∏è {lesson.duration} ‚Ä¢ üéÅ +{lesson.reward} –æ—á–∫–æ–≤</div></div><button onClick={onClose} style={{background:'none',border:'none',color:'var(--text-muted)',fontSize:'20px',cursor:'pointer'}}>‚úï</button></div>
    <div className="modal-body">
      <p style={{marginBottom:'20px',color:'var(--text-muted)',lineHeight:1.5}}>{lesson.desc}</p>
      <div style={{background:'var(--bg-lighter)',borderRadius:'12px',padding:'50px',textAlign:'center',marginBottom:'25px'}}><div style={{fontSize:'50px',marginBottom:'10px'}}>üé¨</div><div style={{color:'var(--text-muted)'}}>–í–∏–¥–µ–æ —É—Ä–æ–∫–∞</div></div>
      <h3 style={{marginBottom:'15px'}}>üìã –ó–∞–¥–∞–Ω–∏—è:</h3>
      {lesson.tasks.map(task=>{const tp=progress.tasks_completed?.find(t=>t.id===task.id);const done=tp?.done||false;return(
        <div key={task.id} onClick={()=>progress.status==='active'&&onToggle(lesson.id,task.id)} style={{display:'flex',alignItems:'center',gap:'12px',padding:'14px',background:'var(--bg-lighter)',borderRadius:'10px',marginBottom:'10px',cursor:progress.status==='active'?'pointer':'default',border:done?'1px solid var(--green)':'1px solid var(--border)',transition:'all .2s'}}>
          <div style={{width:'28px',height:'28px',borderRadius:'50%',border:done?'none':'2px solid var(--border)',background:done?'var(--green)':'transparent',display:'flex',alignItems:'center',justifyContent:'center',color:'#fff',fontSize:'14px',flexShrink:0}}>{done&&'‚úì'}</div>
          <div style={{flex:1}}><div style={{color:done?'var(--green)':'var(--text)',fontWeight:500}}>{task.text}</div>{task.type==='count'&&<div style={{fontSize:'11px',color:'var(--text-muted)',marginTop:'3px'}}>–¶–µ–ª—å: {task.target}</div>}</div>
          {task.type==='integration'&&<span className="tag tag-purple">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</span>}
          {task.type==='video'&&<span className="tag tag-blue">–í–∏–¥–µ–æ</span>}
        </div>
      )})}
    </div>
    <div className="modal-footer">
      <button className="btn btn-secondary" onClick={onClose}>–ó–∞–∫—Ä—ã—Ç—å</button>
      {progress.status==='active'&&<button className="btn btn-primary" onClick={()=>onComplete(lesson.id)} disabled={!allDone}>{allDone?'üéâ –ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–∫':`–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏—è (${progress.tasks_completed?.filter(t=>t.done).length||0}/${lesson.tasks.length})`}</button>}
      {progress.status==='completed'&&<span className="tag tag-green" style={{padding:'10px 20px',fontSize:'13px'}}>‚úì –£—Ä–æ–∫ –ø—Ä–æ–π–¥–µ–Ω</span>}
    </div>
  </div></div>);
};

ReactDOM.render(<App/>,document.getElementById('root'));
</script>
</body>
</html>
