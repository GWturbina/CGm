<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Studio - CardGift</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- –°—Ç–∏–ª–∏ CardGift -->
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/ai-studio.css">
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç - –ë–ï–ó –ó–ê–°–¢–ê–í–ö–ò -->
    <div id="mainContent" class="main-container">
        
        <!-- Trial Banner -->
        <div id="trialBanner" style="display: none;"></div>
        
        <!-- –®–∞–ø–∫–∞ -->
        <header class="studio-header">
            <div class="header-left">
                <a href="dashboard.html" class="back-btn">‚Üê –ù–∞–∑–∞–¥</a>
                <div class="logo">
                    <span class="logo-icon">ü§ñ</span>
                    <span class="logo-text">AI Studio</span>
                    <span class="logo-badge">BETA</span>
                </div>
            </div>
            
            <!-- –ù–û–í–´–ï –ö–ù–û–ü–ö–ò -->
            <div class="header-buttons">
                <button class="btn-rules" onclick="showRulesModal()">
                    üö´ –ü—Ä–∞–≤–∏–ª–∞
                </button>
                <button class="btn-settings-api" onclick="showSettingsModal()">
                    ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API
                </button>
            </div>
            
            <div class="header-center">
                <div class="limits-display">
                    <div class="limit-item" id="textLimit">
                        <span class="limit-icon">üìù</span>
                        <span class="limit-value">0/0</span>
                    </div>
                    <div class="limit-item" id="imageLimit">
                        <span class="limit-icon">üé®</span>
                        <span class="limit-value">0/0</span>
                    </div>
                    <div class="limit-item" id="voiceLimit">
                        <span class="limit-icon">üé§</span>
                        <span class="limit-value">0/0</span>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <div class="credits-display" id="creditsDisplay" title="–í–∞—à–∏ –∫—Ä–µ–¥–∏—Ç—ã">üí≥ 0</div>
                <div class="lang-switcher">
                    <button class="lang-btn" id="langEn" onclick="switchLang('en')">EN</button>
                    <button class="lang-btn active" id="langRu" onclick="switchLang('ru')">RU</button>
                    <button class="lang-btn" id="langUa" onclick="switchLang('ua')">UA</button>
                </div>
                <div class="wallet-info">
                    <div class="wallet-address" id="walletAddress">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</div>
                    <div class="user-level" id="userLevel">Level: 0</div>
                </div>
            </div>
        </header>

        <!-- –¢–∞–±—ã -->
        <nav class="content-tabs">
            <button class="tab-btn active" data-tab="text">
                <span class="tab-icon">üìù</span>
                <span class="tab-name">–¢–µ–∫—Å—Ç</span>
            </button>
            <button class="tab-btn" data-tab="image">
                <span class="tab-icon">üé®</span>
                <span class="tab-name">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>
            </button>
            <button class="tab-btn" data-tab="voice">
                <span class="tab-icon">üé§</span>
                <span class="tab-name">–ì–æ–ª–æ—Å</span>
            </button>
            <button class="tab-btn disabled" data-tab="video">
                <span class="tab-icon">üé¨</span>
                <span class="tab-name">–í–∏–¥–µ–æ</span>
                <span class="coming-soon">Soon</span>
            </button>
            <button class="tab-btn" data-tab="music">
                <span class="tab-icon">üéµ</span>
                <span class="tab-name">–ú—É–∑—ã–∫–∞</span>
            </button>
        </nav>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <main class="studio-main">
            <!-- –®–∞–±–ª–æ–Ω—ã -->
            <aside class="templates-panel">
                <h3>üìã –®–∞–±–ª–æ–Ω—ã</h3>
                <div class="templates-list" id="templatesList"></div>
            </aside>

            <!-- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è -->
            <section class="generation-area">
                <!-- –¢–µ–∫—Å—Ç -->
                <div class="tab-content active" id="textTab">
                    <div class="generation-card">
                        <h2>üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞</h2>
                        <p class="description">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è, –ø–∏—Å—å–º–∞, –ø–æ—Å—Ç—ã —Å –ø–æ–º–æ—â—å—é AI</p>
                        
                        <div class="form-group">
                            <label>–°—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞</label>
                            <select id="textStyle" class="form-select">
                                <option value="greeting">–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ</option>
                                <option value="business">–î–µ–ª–æ–≤–æ–π</option>
                                <option value="motivational">–ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π</option>
                                <option value="friendly">–î—Ä—É–∂–µ—Å–∫–∏–π</option>
                                <option value="romantic">–†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π</option>
                                <option value="club">GlobalWay –∫–ª—É–±</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>–í–∞—à –∑–∞–ø—Ä–æ—Å</label>
                            <textarea id="textPrompt" class="form-textarea" rows="4" 
                                placeholder="–û–ø–∏—à–∏—Ç–µ, –∫–∞–∫–æ–π —Ç–µ–∫—Å—Ç –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å..."></textarea>
                        </div>
                        
                        <button class="btn btn-generate" id="generateTextBtn">
                            ‚ú® –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        
                        <div class="result-area" id="textResult" style="display: none;">
                            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                            <div class="result-content" id="textResultContent"></div>
                            <div class="result-actions">
                                <button class="btn btn-secondary" id="copyTextBtn">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                <button class="btn btn-secondary" id="useTextInCardBtn">üéÅ –í –æ—Ç–∫—Ä—ã—Ç–∫—É</button>
                                <button class="btn btn-primary" onclick="AIStudio.addToProject('text')">üé¨ –í –ø—Ä–æ–µ–∫—Ç</button>
                                <button class="btn btn-secondary" id="saveTextBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
                <div class="tab-content" id="imageTab">
                    <div class="generation-card">
                        <h2>üé® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h2>
                        <p class="description">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏, –±–∞–Ω–Ω–µ—Ä—ã, –æ–±–ª–æ–∂–∫–∏</p>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>–§–æ—Ä–º–∞—Ç</label>
                                <select id="imageFormat" class="form-select">
                                    <option value="1:1">–ö–≤–∞–¥—Ä–∞—Ç (1:1)</option>
                                    <option value="16:9">–®–∏—Ä–æ–∫–∏–π (16:9)</option>
                                    <option value="9:16">–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π (9:16)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–°—Ç–∏–ª—å</label>
                                <select id="imageStyle" class="form-select">
                                    <option value="realistic">–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π</option>
                                    <option value="cartoon">–ú—É–ª—å—Ç—è—à–Ω—ã–π</option>
                                    <option value="artistic">–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea id="imagePrompt" class="form-textarea" rows="4"
                                placeholder="–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏..."></textarea>
                        </div>
                        
                        <button class="btn btn-generate" id="generateImageBtn">‚ú® –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                        
                        <div class="result-area" id="imageResult" style="display: none;">
                            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                            <div class="image-preview" id="imagePreview"></div>
                            <div class="result-actions">
                                <button class="btn btn-secondary" id="downloadImageBtn">üì• –°–∫–∞—á–∞—Ç—å</button>
                                <button class="btn btn-secondary" id="useImageInCardBtn">üéÅ –í –æ—Ç–∫—Ä—ã—Ç–∫—É</button>
                                <button class="btn btn-primary" onclick="AIStudio.addToProject('image')">üé¨ –í –ø—Ä–æ–µ–∫—Ç</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ì–æ–ª–æ—Å -->
                <div class="tab-content" id="voiceTab">
                    <div class="generation-card">
                        <h2>üé§ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ–ª–æ—Å–∞</h2>
                        <p class="description">–ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—É—é —Ä–µ—á—å —Å —ç–º–æ—Ü–∏—è–º–∏</p>
                        
                        <!-- –í—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞ –∏ —è–∑—ã–∫–∞ -->
                        <div class="form-row">
                            <div class="form-group">
                                <label>üó£Ô∏è –ì–æ–ª–æ—Å <button type="button" class="btn-voice-test" id="testVoiceBtn" onclick="AIStudio.testVoice()" title="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å –≥–æ–ª–æ—Å">‚ñ∂Ô∏è –¢–µ—Å—Ç</button></label>
                                <select id="voiceSelect" class="form-select">
                                    <optgroup label="üë® –ú—É–∂—Å–∫–∏–µ">
                                        <option value="alex-nekrasov">–ê–ª–µ–∫—Å –ù–µ–∫—Ä–∞—Å–æ–≤ (—É–≤–µ—Ä–µ–Ω–Ω—ã–π)</option>
                                        <option value="taras-boyko">–¢–∞—Ä–∞—Å –ë–æ–π–∫–æ (—Ä–µ–∑–æ–Ω–∞–Ω—Å–Ω—ã–π)</option>
                                        <option value="vladimir">–í–ª–∞–¥–∏–º–∏—Ä (–ª—ë–≥–∫–∏–π)</option>
                                        <option value="evgeniy">–ï–≤–≥–µ–Ω–∏–π (–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π)</option>
                                        <option value="leonid-drapey">–õ–µ–æ–Ω–∏–¥ –î—Ä–∞–ø–µ–π (–º—É–¥—Ä—ã–π)</option>
                                        <option value="voice-m6">–ì–æ–ª–æ—Å –ú6</option>
                                        <option value="voice-m7">–ì–æ–ª–æ—Å –ú7</option>
                                        <option value="voice-m8">–ì–æ–ª–æ—Å –ú8</option>
                                        <option value="voice-m9">–ì–æ–ª–æ—Å –ú9</option>
                                        <option value="voice-m10">–ì–æ–ª–æ—Å –ú10</option>
                                    </optgroup>
                                    <optgroup label="üë© –ñ–µ–Ω—Å–∫–∏–µ">
                                        <option value="anna-stepanenko">–ê–Ω–Ω–∞ –°—Ç–µ–ø–∞–Ω–µ–Ω–∫–æ (—è—Ä–∫–∞—è)</option>
                                        <option value="voice-f2">–ì–æ–ª–æ—Å –ñ2</option>
                                        <option value="voice-f3">–ì–æ–ª–æ—Å –ñ3</option>
                                        <option value="voice-f4">–ì–æ–ª–æ—Å –ñ4</option>
                                        <option value="voice-f5">–ì–æ–ª–æ—Å –ñ5</option>
                                        <option value="voice-f6">–ì–æ–ª–æ—Å –ñ6</option>
                                        <option value="voice-f7">–ì–æ–ª–æ—Å –ñ7</option>
                                        <option value="voice-f8">–ì–æ–ª–æ—Å –ñ8</option>
                                        <option value="voice-f9">–ì–æ–ª–æ—Å –ñ9</option>
                                        <option value="voice-f10">–ì–æ–ª–æ—Å –ñ10</option>
                                    </optgroup>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>üåç –Ø–∑—ã–∫</label>
                                <select id="voiceLanguage" class="form-select">
                                    <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                                    <option value="en">üá¨üáß English</option>
                                    <option value="uk">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                                    <option value="de">üá©üá™ Deutsch</option>
                                    <option value="fr">üá´üá∑ Fran√ßais</option>
                                    <option value="es">üá™üá∏ Espa√±ol</option>
                                    <option value="pl">üáµüá± Polski</option>
                                    <option value="it">üáÆüáπ Italiano</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- –≠–º–æ—Ü–∏–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å -->
                        <div class="form-row">
                            <div class="form-group">
                                <label>üòä –≠–º–æ—Ü–∏—è</label>
                                <select id="voiceEmotion" class="form-select">
                                    <option value="neutral">üòê –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è</option>
                                    <option value="happy">üòä –†–∞–¥–æ—Å—Ç–Ω–∞—è</option>
                                    <option value="sad">üò¢ –ì—Ä—É—Å—Ç–Ω–∞—è</option>
                                    <option value="excited">ü§© –í–æ–∑–±—É–∂–¥—ë–Ω–Ω–∞—è</option>
                                    <option value="serious">üò§ –°–µ—Ä—å—ë–∑–Ω–∞—è</option>
                                    <option value="friendly">ü§ó –î—Ä—É–∂–µ–ª—é–±–Ω–∞—è</option>
                                    <option value="calm">üòå –°–ø–æ–∫–æ–π–Ω–∞—è</option>
                                    <option value="professional">üíº –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: <span id="speedValue">1.0x</span></label>
                                <input type="range" id="voiceSpeed" class="form-range" min="0.5" max="2.0" step="0.1" value="1.0">
                            </div>
                        </div>
                        
                        <!-- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —á—ë—Ç–∫–æ—Å—Ç—å -->
                        <div class="form-row">
                            <div class="form-group">
                                <label>üéöÔ∏è –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: <span id="stabilityValue">50%</span></label>
                                <input type="range" id="voiceStability" class="form-range" min="0" max="100" step="5" value="50">
                            </div>
                            <div class="form-group">
                                <label>üîä –ß—ë—Ç–∫–æ—Å—Ç—å: <span id="clarityValue">75%</span></label>
                                <input type="range" id="voiceClarity" class="form-range" min="0" max="100" step="5" value="75">
                            </div>
                        </div>
                        
                        <!-- –¢–µ–∫—Å—Ç -->
                        <div class="form-group">
                            <label>üìù –¢–µ–∫—Å—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏</label>
                            <textarea id="voiceText" class="form-textarea" rows="4"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç (–¥–æ 1000 —Å–∏–º–≤–æ–ª–æ–≤)..."></textarea>
                            <div class="char-counter"><span id="voiceCharCount">0</span>/1000</div>
                        </div>
                        
                        <button class="btn btn-generate" id="generateVoiceBtn">üé§ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥–æ–ª–æ—Å</button>
                        
                        <div class="result-area" id="voiceResult" style="display: none;">
                            <h3>üîä –†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                            <div class="audio-player">
                                <audio id="voiceAudio" controls></audio>
                            </div>
                            <div class="result-actions">
                                <button class="btn btn-secondary" id="downloadVoiceBtn">üì• –°–∫–∞—á–∞—Ç—å MP3</button>
                                <button class="btn btn-primary" onclick="AIStudio.addToProject('voice')">üé¨ –í –ø—Ä–æ–µ–∫—Ç</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Video Coming Soon -->
                <div class="tab-content" id="videoTab">
                    <div class="generation-card coming-soon-card">
                        <div class="coming-soon-icon">üé¨</div>
                        <h2>–í–∏–¥–µ–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∫–æ—Ä–æ!</h2>
                        <p class="description">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≥–æ–≤–æ—Ä—è—â–∏–µ –∞–≤–∞—Ç–∞—Ä—ã –∏ –≤–∏–¥–µ–æ-–æ—Ç–∫—Ä—ã—Ç–∫–∏</p>
                    </div>
                </div>

                <!-- Music Tab -->
                <div class="tab-content" id="musicTab">
                    <div class="generation-card">
                        <h3>üéµ –ú—É–∑—ã–∫–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞</h3>
                        <p class="description">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–∫ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–ª–µ–≤–∞ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ–π</p>
                        
                        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
                        <div class="result-area" id="musicResult" style="display: none;">
                            <h4>–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç:</h4>
                            <audio id="musicAudio" controls style="width: 100%; margin: 16px 0;"></audio>
                            <div class="result-actions">
                                <button class="btn btn-secondary" id="downloadMusicBtn">
                                    ‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å
                                </button>
                                <button class="btn btn-primary" onclick="AIStudio.addToProject('music')">
                                    üé¨ –í –ø—Ä–æ–µ–∫—Ç (—Ñ–æ–Ω)
                                </button>
                            </div>
                        </div>
                        
                        <div class="music-info" style="margin-top: 20px; padding: 16px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                            <p style="color: var(--text-muted); font-size: 14px;">
                                üí° –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–µ–∫ —Å–ª–µ–≤–∞ —á—Ç–æ–±—ã –ø—Ä–æ—Å–ª—É—à–∞—Ç—å. 
                                –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: –ü—Ä–æ–µ–∫—Ç + –ê—Ä—Ö–∏–≤ -->
            <aside class="right-panel">
                <!-- –ü–∞–Ω–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ -->
                <div class="project-panel">
                    <div class="project-header">
                        <h3>üé¨ –ü—Ä–æ–µ–∫—Ç <span class="project-counter" id="projectCounter" style="display:none;">0</span></h3>
                        <button class="btn-icon" onclick="AIStudio.clearProject()" title="–û—á–∏—Å—Ç–∏—Ç—å">üóëÔ∏è</button>
                    </div>
                    <div class="project-list" id="projectPanel">
                        <div class="project-empty">–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –ø—Ä–æ–µ–∫—Ç</div>
                    </div>
                    <button class="btn btn-primary btn-full" onclick="AIStudio.openInGlobalStudio()">
                        üé¨ –û—Ç–∫—Ä—ã—Ç—å –≤ GlobalStudio
                    </button>
                </div>

                <!-- –ê—Ä—Ö–∏–≤ -->
                <div class="archive-panel">
                    <h3>üì¶ –ú–æ–π –∞—Ä—Ö–∏–≤</h3>
                    <div class="archive-filters">
                        <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                        <button class="filter-btn" data-filter="text">üìù</button>
                        <button class="filter-btn" data-filter="image">üé®</button>
                        <button class="filter-btn" data-filter="voice">üé§</button>
                    </div>
                    <div class="archive-list" id="archiveList">
                        <div class="archive-empty">–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</div>
                    </div>
                </div>
            </aside>
        </main>

        <!-- –§—É—Ç–µ—Ä -->
        <footer class="studio-footer">
            <div class="footer-links">
                <a href="generator.html">–°–æ–∑–¥–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç–∫—É</a>
                <a href="dashboard.html">–ö–∞–±–∏–Ω–µ—Ç</a>
            </div>
            <div>Powered by <span class="highlight">CardGift</span> √ó <span class="highlight">GlobalWay</span></div>
        </footer>
    </div>

    <!-- ====== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–ê–í–ò–õ - –ù–û–í–û–ï ====== -->
    <div class="modal-overlay" id="rulesModal">
        <div class="modal">
            <div class="modal-header">
                <h3>üö´ –ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h3>
                <button class="modal-close" onclick="closeModal('rulesModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 16px; color: var(--text-muted);">
                    AI Studio –∑–∞–ø—Ä–µ—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ:
                </p>
                <ul class="rules-list">
                    <li><span>üîû –ü–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—è:</span> –ª—é–±–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞</li>
                    <li><span>‚öîÔ∏è –ù–∞—Å–∏–ª–∏–µ:</span> –ø—Ä–∏–∑—ã–≤—ã –∫ –Ω–∞—Å–∏–ª–∏—é, —É–±–∏–π—Å—Ç–≤–∞–º, —Ç–µ—Ä—Ä–æ—Ä–∏–∑–º—É</li>
                    <li><span>üë∂ –ü–µ–¥–æ—Ñ–∏–ª–∏—è:</span> –ª—é–±–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–º–∏</li>
                    <li><span>üè≥Ô∏è‚Äçüåà –õ–ì–ë–¢ –ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∞:</span> –ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∞ –Ω–µ—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π</li>
                    <li><span>üíâ –ù–∞—Ä–∫–æ—Ç–∏–∫–∏:</span> –ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∞ –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ</li>
                    <li><span>üíÄ –≠–∫—Å—Ç—Ä–µ–º–∏–∑–º:</span> —Ä–∞—Å–∏–∑–º, –Ω–∞—Ü–∏–∑–º, –Ω–µ–Ω–∞–≤–∏—Å—Ç—å</li>
                    <li><span>ü§¨ –ú–∞—Ç:</span> –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞</li>
                </ul>
                <p style="margin-top: 16px; padding: 12px; background: rgba(239,68,68,0.1); border-radius: 8px; font-size: 13px;">
                    ‚ö†Ô∏è –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeModal('rulesModal')">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>
    </div>

    <!-- ====== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ù–ê–°–¢–†–û–ï–ö API ====== -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API</h3>
                <button class="modal-close" onclick="closeModal('settingsModal')">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Groq (–¥–ª—è —Ç–µ–∫—Å—Ç–∞ - –ë–ï–°–ü–õ–ê–¢–ù–û!) -->
                <div class="api-setting">
                    <div class="api-setting-header">
                        <div class="api-setting-title">
                            <span>üìù</span> Groq (–¢–µ–∫—Å—Ç)
                            <span style="background:#10b981;color:#fff;padding:2px 6px;border-radius:4px;font-size:10px;margin-left:8px;">–ë–ï–°–ü–õ–ê–¢–ù–û</span>
                        </div>
                        <span class="api-status not-connected" id="groqStatus">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</span>
                    </div>
                    <div class="api-input-row">
                        <input type="password" id="groqKey" placeholder="–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á Groq (gsk_...)">
                        <button class="btn-clear-key" id="clearGroq" onclick="clearApiKey('groq')" title="–û—á–∏—Å—Ç–∏—Ç—å">üóëÔ∏è</button>
                    </div>
                    <div class="api-hint">
                        –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –Ω–∞ <a href="https://console.groq.com/keys" target="_blank">console.groq.com</a>
                        <br><small style="color:#10b981;">14,400 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å! Llama 3.1 70B</small>
                    </div>
                </div>
                
                <!-- ElevenLabs -->
                <div class="api-setting">
                    <div class="api-setting-header">
                        <div class="api-setting-title">
                            <span>üé§</span> ElevenLabs (–ì–æ–ª–æ—Å)
                        </div>
                        <span class="api-status not-connected" id="elevenlabsStatus">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</span>
                    </div>
                    <div class="api-input-row">
                        <input type="password" id="elevenlabsKey" placeholder="–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á ElevenLabs">
                        <button class="btn-clear-key" id="clearElevenlabs" onclick="clearApiKey('elevenlabs')" title="–û—á–∏—Å—Ç–∏—Ç—å">üóëÔ∏è</button>
                    </div>
                    <div class="api-hint">
                        –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –Ω–∞ <a href="https://elevenlabs.io/app/settings/api-keys" target="_blank">elevenlabs.io</a>
                    </div>
                </div>
                
                <!-- OpenAI (DALL-E) -->
                <div class="api-setting">
                    <div class="api-setting-header">
                        <div class="api-setting-title">
                            <span>üé®</span> OpenAI (DALL-E –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫)
                        </div>
                        <span class="api-status not-connected" id="openaiStatus">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</span>
                    </div>
                    <div class="api-input-row">
                        <input type="password" id="openaiKey" placeholder="–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á OpenAI (sk-...)">
                        <button class="btn-clear-key" id="clearOpenai" onclick="clearApiKey('openai')" title="–û—á–∏—Å—Ç–∏—Ç—å">üóëÔ∏è</button>
                    </div>
                    <div class="api-hint">
                        –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –Ω–∞ <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com</a>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('settingsModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="saveApiSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div class="loading-modal" id="loadingModal" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loadingText">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...</p>
        </div>
    </div>

    <!-- –°–ö–†–ò–ü–¢–´ CARDGIFT -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/supabase.js"></script>
    <script src="js/id-linking-service.js"></script>
    <script src="js/globalway-bridge.js"></script>
    <script src="js/content-filter.js"></script>
    <script src="js/voices-data.js"></script>
    <script src="js/music-data.js"></script>
    <script src="js/ai-studio.js"></script>
        <!-- Virtual Assistant -->
    <script src="js/lessons-data.js"></script>
    <script src="js/lessons-data-extended.js"></script>
    <script src="modules/assistant/assistant.js"></script>
    <script src="modules/assistant/assistant-ui.js"></script>
    <script src="modules/assistant/assistant-init.js"></script>
    <script src="modules/assistant/dashboard-integration.js"></script>
    
    <script>
        // ====== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù ======
        
        function showRulesModal() {
            document.getElementById('rulesModal').classList.add('active');
        }
        
        function showSettingsModal() {
            document.getElementById('settingsModal').classList.add('active');
            loadApiKeys();
        }
        
        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ –æ–≤–µ—Ä–ª–µ–π
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                }
            });
        });
        
        // ====== API –ö–õ–Æ–ß–ò (v2.0 - –° GROQ) ======
        
        // –ü–æ–ª—É—á–∏—Ç—å wallet –∞–¥—Ä–µ—Å
        function getWalletAddress() {
            return window.AIStudio?.state?.walletAddress 
                || localStorage.getItem('cardgift_wallet')
                || localStorage.getItem('walletAddress');
        }
        
        async function saveApiSettings() {
            const groqKey = document.getElementById('groqKey').value.trim();
            const elevenlabsKey = document.getElementById('elevenlabsKey').value.trim();
            const openaiKey = document.getElementById('openaiKey').value.trim();
            const wallet = getWalletAddress();
            
            if (!wallet) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª—ë–∫');
                return;
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫–∏–µ –∫–ª—é—á–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å
            const currentKeys = await loadApiKeysFromSupabase(wallet);
            const keysToSave = {};
            
            if (groqKey && !groqKey.includes('‚Ä¢')) {
                keysToSave.groq_api_key = groqKey;
            } else if (currentKeys.groq) {
                keysToSave.groq_api_key = currentKeys.groq;
            }
            
            if (elevenlabsKey && !elevenlabsKey.includes('‚Ä¢')) {
                keysToSave.elevenlabs_api_key = elevenlabsKey;
            } else if (currentKeys.elevenlabs) {
                keysToSave.elevenlabs_api_key = currentKeys.elevenlabs;
            }
            
            if (openaiKey && !openaiKey.includes('‚Ä¢')) {
                keysToSave.openai_api_key = openaiKey;
            } else if (currentKeys.openai) {
                keysToSave.openai_api_key = currentKeys.openai;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            try {
                if (window.SupabaseClient && SupabaseClient.client) {
                    const { error } = await SupabaseClient.client
                        .from('ai_credits')
                        .update({
                            groq_api_key: keysToSave.groq_api_key || null,
                            openai_api_key: keysToSave.openai_api_key || null,
                            elevenlabs_api_key: keysToSave.elevenlabs_api_key || null,
                            updated_at: new Date().toISOString()
                        })
                        .eq('wallet_address', wallet.toLowerCase());
                    
                    if (error) {
                        // –ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞—ë–º
                        if (error.code === 'PGRST116') {
                            await SupabaseClient.client
                                .from('ai_credits')
                                .insert({
                                    wallet_address: wallet.toLowerCase(),
                                    groq_api_key: keysToSave.groq_api_key || null,
                                    openai_api_key: keysToSave.openai_api_key || null,
                                    elevenlabs_api_key: keysToSave.elevenlabs_api_key || null,
                                    balance: 0,
                                    daily_limit: 50
                                });
                        } else {
                            throw error;
                        }
                    }
                }
                
                // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –∫–∞–∫ –∫–µ—à
                localStorage.setItem('ai_studio_api_keys', JSON.stringify({
                    groq: keysToSave.groq_api_key,
                    openai: keysToSave.openai_api_key,
                    elevenlabs: keysToSave.elevenlabs_api_key
                }));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                if (keysToSave.groq_api_key) {
                    document.getElementById('groqStatus').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω';
                    document.getElementById('groqStatus').className = 'api-status connected';
                }
                if (keysToSave.elevenlabs_api_key) {
                    document.getElementById('elevenlabsStatus').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω';
                    document.getElementById('elevenlabsStatus').className = 'api-status connected';
                }
                if (keysToSave.openai_api_key) {
                    document.getElementById('openaiStatus').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω';
                    document.getElementById('openaiStatus').className = 'api-status connected';
                }
                
                closeModal('settingsModal');
                alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∞–∫–∫–∞—É–Ω—Ç');
                
            } catch (e) {
                console.error('Save API keys error:', e);
                alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + e.message);
            }
        }
        
        async function loadApiKeysFromSupabase(wallet) {
            if (!wallet || !window.SupabaseClient || !SupabaseClient.client) {
                return { groq: null, openai: null, elevenlabs: null };
            }
            
            try {
                const { data, error } = await SupabaseClient.client
                    .from('ai_credits')
                    .select('groq_api_key, openai_api_key, elevenlabs_api_key')
                    .eq('wallet_address', wallet.toLowerCase())
                    .single();
                
                if (!error && data) {
                    return {
                        groq: data.groq_api_key,
                        openai: data.openai_api_key,
                        elevenlabs: data.elevenlabs_api_key
                    };
                }
            } catch (e) {
                console.warn('Load API keys error:', e);
            }
            
            return { groq: null, openai: null, elevenlabs: null };
        }
        
        async function loadApiKeys() {
            const wallet = getWalletAddress();
            let keys = { groq: null, openai: null, elevenlabs: null };
            
            // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º Supabase
            if (wallet) {
                keys = await loadApiKeysFromSupabase(wallet);
                
                // –ö–µ—à–∏—Ä—É–µ–º –≤ localStorage
                if (keys.groq || keys.openai || keys.elevenlabs) {
                    localStorage.setItem('ai_studio_api_keys', JSON.stringify(keys));
                }
            }
            
            // Fallback –Ω–∞ localStorage
            if (!keys.groq && !keys.openai && !keys.elevenlabs) {
                const saved = localStorage.getItem('ai_studio_api_keys');
                if (saved) {
                    keys = JSON.parse(saved);
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            if (keys.groq) {
                document.getElementById('groqKey').value = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                document.getElementById('groqStatus').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω';
                document.getElementById('groqStatus').className = 'api-status connected';
            }
            if (keys.elevenlabs) {
                document.getElementById('elevenlabsKey').value = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                document.getElementById('elevenlabsStatus').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω';
                document.getElementById('elevenlabsStatus').className = 'api-status connected';
            }
            if (keys.openai) {
                document.getElementById('openaiKey').value = '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
                document.getElementById('openaiStatus').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω';
                document.getElementById('openaiStatus').className = 'api-status connected';
            }
            
            updateClearButtonsVisibility();
        }
        
        async function clearApiKey(keyType) {
            const keyNames = {
                groq: 'Groq',
                elevenlabs: 'ElevenLabs',
                openai: 'OpenAI'
            };
            
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –∫–ª—é—á ${keyNames[keyType] || keyType}?`)) {
                return;
            }
            
            const wallet = getWalletAddress();
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ Supabase
            if (wallet && window.SupabaseClient && SupabaseClient.client) {
                try {
                    const updateData = {};
                    updateData[keyType + '_api_key'] = null;
                    
                    await SupabaseClient.client
                        .from('ai_credits')
                        .update(updateData)
                        .eq('wallet_address', wallet.toLowerCase());
                } catch (e) {
                    console.warn('Clear API key error:', e);
                }
            }
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ localStorage
            const saved = localStorage.getItem('ai_studio_api_keys');
            const keys = saved ? JSON.parse(saved) : {};
            delete keys[keyType];
            localStorage.setItem('ai_studio_api_keys', JSON.stringify(keys));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            const inputEl = document.getElementById(keyType + 'Key');
            const statusEl = document.getElementById(keyType + 'Status');
            
            if (inputEl) inputEl.value = '';
            if (statusEl) {
                statusEl.textContent = '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω';
                statusEl.className = 'api-status not-connected';
            }
            
            alert(`‚úÖ –ö–ª—é—á ${keyNames[keyType] || keyType} —É–¥–∞–ª—ë–Ω`);
        }
        
        function updateClearButtonsVisibility() {
            const canSee = window.AIStudio && window.AIStudio.canUseOwnApi && window.AIStudio.canUseOwnApi();
            
            const clearGroq = document.getElementById('clearGroq');
            const clearElevenlabs = document.getElementById('clearElevenlabs');
            const clearOpenai = document.getElementById('clearOpenai');
            
            if (clearGroq) clearGroq.classList.toggle('visible', canSee);
            if (clearElevenlabs) clearElevenlabs.classList.toggle('visible', canSee);
            if (clearOpenai) clearOpenai.classList.toggle('visible', canSee);
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞
        function switchLang(lang) {
            localStorage.setItem('preferredLanguage', lang);
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('lang' + lang.charAt(0).toUpperCase() + lang.slice(1))?.classList.add('active');
        }
    </script>
</body>
</html>
